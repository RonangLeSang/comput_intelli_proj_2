{"test_class": {"identifier": "TestJobHistoryFileParserHadoop2", "superclass": "", "interfaces": "", "fields": [], "file": "hraven-etl/src/test/java/com/twitter/hraven/etl/TestJobHistoryFileParserHadoop2.java"}, "test_case": {"identifier": "testIntExpGetValuesIntBytes", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testIntExpGetValuesIntBytes() {\n\n    String[] keysToBeChecked = {\"httpPort\"};\n    byte[] byteValue = null;\n    int intValue10 = 10;\n\n    JobHistoryFileParserHadoop2 jh = new JobHistoryFileParserHadoop2(null);\n\n    for(String key: keysToBeChecked) {\n      byteValue = jh.getValue(JobHistoryKeys.HADOOP2_TO_HADOOP1_MAPPING.get(key), intValue10);\n      assertEquals(Bytes.toInt(byteValue), intValue10);\n     }\n  }", "signature": "void testIntExpGetValuesIntBytes()", "full_signature": "@Test public void testIntExpGetValuesIntBytes()", "class_method_signature": "TestJobHistoryFileParserHadoop2.testIntExpGetValuesIntBytes()", "testcase": true, "constructor": false, "invocations": ["getValue", "get", "assertEquals", "toInt"]}, "focal_class": {"identifier": "JobHistoryFileParserHadoop2", "superclass": "extends JobHistoryFileParserBase", "interfaces": "", "fields": [{"original_string": "private JobKey jobKey;", "modifier": "private", "type": "JobKey", "declarator": "jobKey", "var_name": "jobKey"}, {"original_string": "private String jobNumber = \"\";", "modifier": "private", "type": "String", "declarator": "jobNumber = \"\"", "var_name": "jobNumber"}, {"original_string": "private byte[] jobKeyBytes;", "modifier": "private", "type": "byte[]", "declarator": "jobKeyBytes", "var_name": "jobKeyBytes"}, {"original_string": "private JobDetails jobDetails = null;", "modifier": "private", "type": "JobDetails", "declarator": "jobDetails = null", "var_name": "jobDetails"}, {"original_string": "private List<Put> jobPuts = new LinkedList<Put>();", "modifier": "private", "type": "List<Put>", "declarator": "jobPuts = new LinkedList<Put>()", "var_name": "jobPuts"}, {"original_string": "private List<Put> taskPuts = new LinkedList<Put>();", "modifier": "private", "type": "List<Put>", "declarator": "taskPuts = new LinkedList<Put>()", "var_name": "taskPuts"}, {"original_string": "boolean uberized = false;", "modifier": "", "type": "boolean", "declarator": "uberized = false", "var_name": "uberized"}, {"original_string": "private String jobStatus = \"\";", "modifier": "private", "type": "String", "declarator": "jobStatus = \"\"", "var_name": "jobStatus"}, {"original_string": "public static final String JOB_STATUS_SUCCEEDED = \"SUCCEEDED\";", "modifier": "public static final", "type": "String", "declarator": "JOB_STATUS_SUCCEEDED = \"SUCCEEDED\"", "var_name": "JOB_STATUS_SUCCEEDED"}, {"original_string": "private long mapMbMillis = Constants.NOTFOUND_VALUE;", "modifier": "private", "type": "long", "declarator": "mapMbMillis = Constants.NOTFOUND_VALUE", "var_name": "mapMbMillis"}, {"original_string": "private long reduceMbMillis = Constants.NOTFOUND_VALUE;", "modifier": "private", "type": "long", "declarator": "reduceMbMillis = Constants.NOTFOUND_VALUE", "var_name": "reduceMbMillis"}, {"original_string": "private static final String LAUNCH_TIME_KEY_STR = JobHistoryKeys.LAUNCH_TIME.toString();", "modifier": "private static final", "type": "String", "declarator": "LAUNCH_TIME_KEY_STR = JobHistoryKeys.LAUNCH_TIME.toString()", "var_name": "LAUNCH_TIME_KEY_STR"}, {"original_string": "private static final String FINISH_TIME_KEY_STR = JobHistoryKeys.FINISH_TIME.toString();", "modifier": "private static final", "type": "String", "declarator": "FINISH_TIME_KEY_STR = JobHistoryKeys.FINISH_TIME.toString()", "var_name": "FINISH_TIME_KEY_STR"}, {"original_string": "private JobKeyConverter jobKeyConv = new JobKeyConverter();", "modifier": "private", "type": "JobKeyConverter", "declarator": "jobKeyConv = new JobKeyConverter()", "var_name": "jobKeyConv"}, {"original_string": "private TaskKeyConverter taskKeyConv = new TaskKeyConverter();", "modifier": "private", "type": "TaskKeyConverter", "declarator": "taskKeyConv = new TaskKeyConverter()", "var_name": "taskKeyConv"}, {"original_string": "private static final String AM_ATTEMPT_PREFIX = \"AM_\";", "modifier": "private static final", "type": "String", "declarator": "AM_ATTEMPT_PREFIX = \"AM_\"", "var_name": "AM_ATTEMPT_PREFIX"}, {"original_string": "private static final String TASK_PREFIX = \"task_\";", "modifier": "private static final", "type": "String", "declarator": "TASK_PREFIX = \"task_\"", "var_name": "TASK_PREFIX"}, {"original_string": "private static final String TASK_ATTEMPT_PREFIX = \"attempt_\";", "modifier": "private static final", "type": "String", "declarator": "TASK_ATTEMPT_PREFIX = \"attempt_\"", "var_name": "TASK_ATTEMPT_PREFIX"}, {"original_string": "private static final Log LOG = LogFactory.getLog(JobHistoryFileParserHadoop2.class);", "modifier": "private static final", "type": "Log", "declarator": "LOG = LogFactory.getLog(JobHistoryFileParserHadoop2.class)", "var_name": "LOG"}, {"original_string": "private Schema schema;", "modifier": "private", "type": "Schema", "declarator": "schema", "var_name": "schema"}, {"original_string": "private Decoder decoder;", "modifier": "private", "type": "Decoder", "declarator": "decoder", "var_name": "decoder"}, {"original_string": "private DatumReader<GenericRecord> reader;", "modifier": "private", "type": "DatumReader<GenericRecord>", "declarator": "reader", "var_name": "reader"}, {"original_string": "private static final String TYPE = \"type\";", "modifier": "private static final", "type": "String", "declarator": "TYPE = \"type\"", "var_name": "TYPE"}, {"original_string": "private static final String EVENT = \"event\";", "modifier": "private static final", "type": "String", "declarator": "EVENT = \"event\"", "var_name": "EVENT"}, {"original_string": "private static final String NAME = \"name\";", "modifier": "private static final", "type": "String", "declarator": "NAME = \"name\"", "var_name": "NAME"}, {"original_string": "private static final String FIELDS = \"fields\";", "modifier": "private static final", "type": "String", "declarator": "FIELDS = \"fields\"", "var_name": "FIELDS"}, {"original_string": "private static final String COUNTS = \"counts\";", "modifier": "private static final", "type": "String", "declarator": "COUNTS = \"counts\"", "var_name": "COUNTS"}, {"original_string": "private static final String GROUPS = \"groups\";", "modifier": "private static final", "type": "String", "declarator": "GROUPS = \"groups\"", "var_name": "GROUPS"}, {"original_string": "private static final String VALUE = \"value\";", "modifier": "private static final", "type": "String", "declarator": "VALUE = \"value\"", "var_name": "VALUE"}, {"original_string": "private static final String TASKID = \"taskid\";", "modifier": "private static final", "type": "String", "declarator": "TASKID = \"taskid\"", "var_name": "TASKID"}, {"original_string": "private static final String APPLICATION_ATTEMPTID = \"applicationAttemptId\";", "modifier": "private static final", "type": "String", "declarator": "APPLICATION_ATTEMPTID = \"applicationAttemptId\"", "var_name": "APPLICATION_ATTEMPTID"}, {"original_string": "private static final String ATTEMPTID = \"attemptId\";", "modifier": "private static final", "type": "String", "declarator": "ATTEMPTID = \"attemptId\"", "var_name": "ATTEMPTID"}, {"original_string": "private static final String TYPE_INT = \"int\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_INT = \"int\"", "var_name": "TYPE_INT"}, {"original_string": "private static final String TYPE_BOOLEAN = \"boolean\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_BOOLEAN = \"boolean\"", "var_name": "TYPE_BOOLEAN"}, {"original_string": "private static final String TYPE_LONG = \"long\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_LONG = \"long\"", "var_name": "TYPE_LONG"}, {"original_string": "private static final String TYPE_STRING = \"String\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_STRING = \"String\"", "var_name": "TYPE_STRING"}, {"original_string": "private static final String TYPE_MAP_STRINGS = \"{\\\"type\\\":\\\"map\\\",\\\"values\\\":\\\"string\\\"}\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_MAP_STRINGS = \"{\\\"type\\\":\\\"map\\\",\\\"values\\\":\\\"string\\\"}\"", "var_name": "TYPE_MAP_STRINGS"}, {"original_string": "private static final String TYPE_ARRAY_INTS = \"{\\\"type\\\":\\\"array\\\",\\\"items\\\":\\\"int\\\"}\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_ARRAY_INTS = \"{\\\"type\\\":\\\"array\\\",\\\"items\\\":\\\"int\\\"}\"", "var_name": "TYPE_ARRAY_INTS"}, {"original_string": "private static final String NULL_STRING = \"[\\\"null\\\",\\\"string\\\"]\";", "modifier": "private static final", "type": "String", "declarator": "NULL_STRING = \"[\\\"null\\\",\\\"string\\\"]\"", "var_name": "NULL_STRING"}, {"original_string": "private static Map<String,Hadoop2RecordType> EVENT_RECORD_NAMES = Maps.newHashMap();", "modifier": "private static", "type": "Map<String,Hadoop2RecordType>", "declarator": "EVENT_RECORD_NAMES = Maps.newHashMap()", "var_name": "EVENT_RECORD_NAMES"}, {"original_string": "private static final Set<String> COUNTER_NAMES = new HashSet<String>();", "modifier": "private static final", "type": "Set<String>", "declarator": "COUNTER_NAMES = new HashSet<String>()", "var_name": "COUNTER_NAMES"}, {"original_string": "private Map<Hadoop2RecordType, Map<String, String>> fieldTypes =\n      new HashMap<Hadoop2RecordType, Map<String, String>>();", "modifier": "private", "type": "Map<Hadoop2RecordType, Map<String, String>>", "declarator": "fieldTypes =\n      new HashMap<Hadoop2RecordType, Map<String, String>>()", "var_name": "fieldTypes"}], "methods": [{"identifier": "JobHistoryFileParserHadoop2", "parameters": "(Configuration conf)", "modifiers": "", "return": "", "signature": " JobHistoryFileParserHadoop2(Configuration conf)", "full_signature": "  JobHistoryFileParserHadoop2(Configuration conf)", "class_method_signature": "JobHistoryFileParserHadoop2.JobHistoryFileParserHadoop2(Configuration conf)", "testcase": false, "constructor": true}, {"identifier": "parse", "parameters": "(byte[] historyFileContents, JobKey jobKey)", "modifiers": "@Override public", "return": "void", "signature": "void parse(byte[] historyFileContents, JobKey jobKey)", "full_signature": "@Override public void parse(byte[] historyFileContents, JobKey jobKey)", "class_method_signature": "JobHistoryFileParserHadoop2.parse(byte[] historyFileContents, JobKey jobKey)", "testcase": false, "constructor": false}, {"identifier": "initializeJobDetails", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void initializeJobDetails()", "full_signature": "private void initializeJobDetails()", "class_method_signature": "JobHistoryFileParserHadoop2.initializeJobDetails()", "testcase": false, "constructor": false}, {"identifier": "getJobStatusPut", "parameters": "()", "modifiers": "private", "return": "Put", "signature": "Put getJobStatusPut()", "full_signature": "private Put getJobStatusPut()", "class_method_signature": "JobHistoryFileParserHadoop2.getJobStatusPut()", "testcase": false, "constructor": false}, {"identifier": "understandSchema", "parameters": "(String schema)", "modifiers": "private", "return": "void", "signature": "void understandSchema(String schema)", "full_signature": "private void understandSchema(String schema)", "class_method_signature": "JobHistoryFileParserHadoop2.understandSchema(String schema)", "testcase": false, "constructor": false}, {"identifier": "processCounters", "parameters": "(Put p, JSONObject eventDetails, String key)", "modifiers": "private", "return": "void", "signature": "void processCounters(Put p, JSONObject eventDetails, String key)", "full_signature": "private void processCounters(Put p, JSONObject eventDetails, String key)", "class_method_signature": "JobHistoryFileParserHadoop2.processCounters(Put p, JSONObject eventDetails, String key)", "testcase": false, "constructor": false}, {"identifier": "processAllTypes", "parameters": "(Put p, Hadoop2RecordType recType, JSONObject eventDetails, String key)", "modifiers": "private", "return": "void", "signature": "void processAllTypes(Put p, Hadoop2RecordType recType, JSONObject eventDetails, String key)", "full_signature": "private void processAllTypes(Put p, Hadoop2RecordType recType, JSONObject eventDetails, String key)", "class_method_signature": "JobHistoryFileParserHadoop2.processAllTypes(Put p, Hadoop2RecordType recType, JSONObject eventDetails, String key)", "testcase": false, "constructor": false}, {"identifier": "iterateAndPreparePuts", "parameters": "(JSONObject eventDetails, Put p, Hadoop2RecordType recType)", "modifiers": "private", "return": "void", "signature": "void iterateAndPreparePuts(JSONObject eventDetails, Put p, Hadoop2RecordType recType)", "full_signature": "private void iterateAndPreparePuts(JSONObject eventDetails, Put p, Hadoop2RecordType recType)", "class_method_signature": "JobHistoryFileParserHadoop2.iterateAndPreparePuts(JSONObject eventDetails, Put p, Hadoop2RecordType recType)", "testcase": false, "constructor": false}, {"identifier": "processRecords", "parameters": "(Hadoop2RecordType recType, JSONObject eventDetails)", "modifiers": "private", "return": "void", "signature": "void processRecords(Hadoop2RecordType recType, JSONObject eventDetails)", "full_signature": "private void processRecords(Hadoop2RecordType recType, JSONObject eventDetails)", "class_method_signature": "JobHistoryFileParserHadoop2.processRecords(Hadoop2RecordType recType, JSONObject eventDetails)", "testcase": false, "constructor": false}, {"identifier": "setJobId", "parameters": "(String id)", "modifiers": "private", "return": "void", "signature": "void setJobId(String id)", "full_signature": "private void setJobId(String id)", "class_method_signature": "JobHistoryFileParserHadoop2.setJobId(String id)", "testcase": false, "constructor": false}, {"identifier": "getKey", "parameters": "(String key)", "modifiers": "private", "return": "String", "signature": "String getKey(String key)", "full_signature": "private String getKey(String key)", "class_method_signature": "JobHistoryFileParserHadoop2.getKey(String key)", "testcase": false, "constructor": false}, {"identifier": "populatePut", "parameters": "(Put p, byte[] family, String key, long value)", "modifiers": "private", "return": "void", "signature": "void populatePut(Put p, byte[] family, String key, long value)", "full_signature": "private void populatePut(Put p, byte[] family, String key, long value)", "class_method_signature": "JobHistoryFileParserHadoop2.populatePut(Put p, byte[] family, String key, long value)", "testcase": false, "constructor": false}, {"identifier": "getValue", "parameters": "(String key, int value)", "modifiers": "", "return": "byte[]", "signature": "byte[] getValue(String key, int value)", "full_signature": " byte[] getValue(String key, int value)", "class_method_signature": "JobHistoryFileParserHadoop2.getValue(String key, int value)", "testcase": false, "constructor": false}, {"identifier": "populatePut", "parameters": "(Put p, byte[] family, String key, int value)", "modifiers": "private", "return": "void", "signature": "void populatePut(Put p, byte[] family, String key, int value)", "full_signature": "private void populatePut(Put p, byte[] family, String key, int value)", "class_method_signature": "JobHistoryFileParserHadoop2.populatePut(Put p, byte[] family, String key, int value)", "testcase": false, "constructor": false}, {"identifier": "populatePut", "parameters": "(Put p, byte[] family, String key, String value)", "modifiers": "private", "return": "void", "signature": "void populatePut(Put p, byte[] family, String key, String value)", "full_signature": "private void populatePut(Put p, byte[] family, String key, String value)", "class_method_signature": "JobHistoryFileParserHadoop2.populatePut(Put p, byte[] family, String key, String value)", "testcase": false, "constructor": false}, {"identifier": "populatePut", "parameters": "(Put p, byte[] family, String key, String groupName, String counterName,\n      Long counterValue)", "modifiers": "private", "return": "void", "signature": "void populatePut(Put p, byte[] family, String key, String groupName, String counterName,\n      Long counterValue)", "full_signature": "private void populatePut(Put p, byte[] family, String key, String groupName, String counterName,\n      Long counterValue)", "class_method_signature": "JobHistoryFileParserHadoop2.populatePut(Put p, byte[] family, String key, String groupName, String counterName,\n      Long counterValue)", "testcase": false, "constructor": false}, {"identifier": "getMemoryMb", "parameters": "(String key)", "modifiers": "private", "return": "long", "signature": "long getMemoryMb(String key)", "full_signature": "private long getMemoryMb(String key)", "class_method_signature": "JobHistoryFileParserHadoop2.getMemoryMb(String key)", "testcase": false, "constructor": false}, {"identifier": "getStandardizedCounterValue", "parameters": "(String counterName, Long counterValue)", "modifiers": "@Deprecated private", "return": "Long", "signature": "Long getStandardizedCounterValue(String counterName, Long counterValue)", "full_signature": "@Deprecated private Long getStandardizedCounterValue(String counterName, Long counterValue)", "class_method_signature": "JobHistoryFileParserHadoop2.getStandardizedCounterValue(String counterName, Long counterValue)", "testcase": false, "constructor": false}, {"identifier": "getTaskKey", "parameters": "(String prefix, String jobNumber, String fullId)", "modifiers": "public", "return": "byte[]", "signature": "byte[] getTaskKey(String prefix, String jobNumber, String fullId)", "full_signature": "public byte[] getTaskKey(String prefix, String jobNumber, String fullId)", "class_method_signature": "JobHistoryFileParserHadoop2.getTaskKey(String prefix, String jobNumber, String fullId)", "testcase": false, "constructor": false}, {"identifier": "getAMKey", "parameters": "(String prefix, String fullId)", "modifiers": "public", "return": "byte[]", "signature": "byte[] getAMKey(String prefix, String fullId)", "full_signature": "public byte[] getAMKey(String prefix, String fullId)", "class_method_signature": "JobHistoryFileParserHadoop2.getAMKey(String prefix, String fullId)", "testcase": false, "constructor": false}, {"identifier": "getJobPuts", "parameters": "()", "modifiers": "@Override public", "return": "List<Put>", "signature": "List<Put> getJobPuts()", "full_signature": "@Override public List<Put> getJobPuts()", "class_method_signature": "JobHistoryFileParserHadoop2.getJobPuts()", "testcase": false, "constructor": false}, {"identifier": "getTaskPuts", "parameters": "()", "modifiers": "@Override public", "return": "List<Put>", "signature": "List<Put> getTaskPuts()", "full_signature": "@Override public List<Put> getTaskPuts()", "class_method_signature": "JobHistoryFileParserHadoop2.getTaskPuts()", "testcase": false, "constructor": false}, {"identifier": "printAllPuts", "parameters": "(List<Put> p)", "modifiers": "public", "return": "void", "signature": "void printAllPuts(List<Put> p)", "full_signature": "public void printAllPuts(List<Put> p)", "class_method_signature": "JobHistoryFileParserHadoop2.printAllPuts(List<Put> p)", "testcase": false, "constructor": false}, {"identifier": "getMegaByteMillis", "parameters": "()", "modifiers": "@Override public", "return": "Long", "signature": "Long getMegaByteMillis()", "full_signature": "@Override public Long getMegaByteMillis()", "class_method_signature": "JobHistoryFileParserHadoop2.getMegaByteMillis()", "testcase": false, "constructor": false}, {"identifier": "getJobDetails", "parameters": "()", "modifiers": "@Override public", "return": "JobDetails", "signature": "JobDetails getJobDetails()", "full_signature": "@Override public JobDetails getJobDetails()", "class_method_signature": "JobHistoryFileParserHadoop2.getJobDetails()", "testcase": false, "constructor": false}, {"identifier": "getMapMbMillis", "parameters": "()", "modifiers": "public", "return": "long", "signature": "long getMapMbMillis()", "full_signature": "public long getMapMbMillis()", "class_method_signature": "JobHistoryFileParserHadoop2.getMapMbMillis()", "testcase": false, "constructor": false}, {"identifier": "setMapMbMillis", "parameters": "(long mapMbMillis)", "modifiers": "public", "return": "void", "signature": "void setMapMbMillis(long mapMbMillis)", "full_signature": "public void setMapMbMillis(long mapMbMillis)", "class_method_signature": "JobHistoryFileParserHadoop2.setMapMbMillis(long mapMbMillis)", "testcase": false, "constructor": false}, {"identifier": "getReduceMbMillis", "parameters": "()", "modifiers": "public", "return": "long", "signature": "long getReduceMbMillis()", "full_signature": "public long getReduceMbMillis()", "class_method_signature": "JobHistoryFileParserHadoop2.getReduceMbMillis()", "testcase": false, "constructor": false}, {"identifier": "setReduceMbMillis", "parameters": "(long reduceMbMillis)", "modifiers": "public", "return": "void", "signature": "void setReduceMbMillis(long reduceMbMillis)", "full_signature": "public void setReduceMbMillis(long reduceMbMillis)", "class_method_signature": "JobHistoryFileParserHadoop2.setReduceMbMillis(long reduceMbMillis)", "testcase": false, "constructor": false}], "file": "hraven-etl/src/main/java/com/twitter/hraven/etl/JobHistoryFileParserHadoop2.java"}, "focal_method": {"identifier": "getValue", "parameters": "(String key, int value)", "modifiers": "", "return": "byte[]", "body": "byte[] getValue(String key, int value) {\n    byte[] valueBytes = null;\n    Class<?> clazz = JobHistoryKeys.KEY_TYPES.get(JobHistoryKeys.valueOf(key));\n    if (clazz == null) {\n      throw new IllegalArgumentException(\" unknown key \" + key + \" encountered while parsing \"\n          + this.jobKey);\n    }\n    if (Long.class.equals(clazz)) {\n      valueBytes = (value != 0L) ? Bytes.toBytes(new Long(value)) : Constants.ZERO_LONG_BYTES;\n    } else {\n      valueBytes = (value != 0) ? Bytes.toBytes(value) : Constants.ZERO_INT_BYTES;\n    }\n    return valueBytes;\n  }", "signature": "byte[] getValue(String key, int value)", "full_signature": " byte[] getValue(String key, int value)", "class_method_signature": "JobHistoryFileParserHadoop2.getValue(String key, int value)", "testcase": false, "constructor": false, "invocations": ["get", "valueOf", "equals", "toBytes", "toBytes"]}, "repository": {"repo_id": 10953866, "url": "https://github.com/twitter/hraven", "language": "Java", "is_fork": false, "fork_count": 66, "stargazer_count": 126, "size": 1235, "license": "licensed"}}