{"test_class": {"identifier": "LastCd4CountCalculationTest", "superclass": "extends BaseModuleContextSensitiveTest", "interfaces": "", "fields": [], "file": "api/src/test/java/org/openmrs/module/kenyaemr/calculation/library/hiv/LastCd4CountCalculationTest.java"}, "test_case": {"identifier": "evaluate_shouldCalculateLastCD4", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void evaluate_shouldCalculateLastCD4() throws Exception {\n\t\tConcept cd4 = Dictionary.getConcept(Dictionary.CD4_COUNT);\n\n\t\t// Give patient #7 some CD4 obs\n\t\tTestUtils.saveObs(TestUtils.getPatient(7), cd4, 123d, TestUtils.date(2012, 12, 1));\n\t\tTestUtils.saveObs(TestUtils.getPatient(7), cd4, 150d, TestUtils.date(2010, 11, 1));\n\t\t\n\t\tList<Integer> ptIds = Arrays.asList(6, 7);\n\t\tCalculationResultMap resultMap = new LastCd4CountCalculation().evaluate(ptIds, null, Context.getService(PatientCalculationService.class).createCalculationContext());\n\t\tAssert.assertNull(resultMap.get(6)); // has no recorded CD4\n\t\tAssert.assertEquals(new Double(123d), ((Obs) resultMap.get(7).getValue()).getValueNumeric());\n\t}", "signature": "void evaluate_shouldCalculateLastCD4()", "full_signature": "@Test public void evaluate_shouldCalculateLastCD4()", "class_method_signature": "LastCd4CountCalculationTest.evaluate_shouldCalculateLastCD4()", "testcase": true, "constructor": false, "invocations": ["getConcept", "saveObs", "getPatient", "date", "saveObs", "getPatient", "date", "asList", "evaluate", "createCalculationContext", "getService", "assertNull", "get", "assertEquals", "getValueNumeric", "getValue", "get"]}, "focal_class": {"identifier": "LastCd4CountCalculation", "superclass": "extends AbstractPatientCalculation", "interfaces": "", "fields": [], "methods": [{"identifier": "evaluate", "parameters": "(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "modifiers": "@Override public", "return": "CalculationResultMap", "signature": "CalculationResultMap evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "full_signature": "@Override public CalculationResultMap evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "class_method_signature": "LastCd4CountCalculation.evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "testcase": false, "constructor": false}], "file": "api/src/main/java/org/openmrs/module/kenyaemr/calculation/library/hiv/LastCd4CountCalculation.java"}, "focal_method": {"identifier": "evaluate", "parameters": "(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "modifiers": "@Override public", "return": "CalculationResultMap", "body": "@Override\n\tpublic CalculationResultMap evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context) {\n\t\treturn Calculations.lastObs(Dictionary.getConcept(Dictionary.CD4_COUNT), cohort, context);\n\t}", "signature": "CalculationResultMap evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "full_signature": "@Override public CalculationResultMap evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "class_method_signature": "LastCd4CountCalculation.evaluate(Collection<Integer> cohort, Map<String, Object> parameterValues, PatientCalculationContext context)", "testcase": false, "constructor": false, "invocations": ["lastObs", "getConcept"]}, "repository": {"repo_id": 4189503, "url": "https://github.com/I-TECH/openmrs-module-kenyaemr", "language": "Java", "is_fork": false, "fork_count": 127, "stargazer_count": 18, "size": 25410, "license": "licensed"}}