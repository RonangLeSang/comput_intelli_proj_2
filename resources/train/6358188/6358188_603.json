{"test_class": {"identifier": "TimeseriesQueryQueryToolChestTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TIMESTAMP_RESULT_FIELD_NAME = \"d0\";", "modifier": "private static final", "type": "String", "declarator": "TIMESTAMP_RESULT_FIELD_NAME = \"d0\"", "var_name": "TIMESTAMP_RESULT_FIELD_NAME"}, {"original_string": "private static final TimeseriesQueryQueryToolChest TOOL_CHEST = new TimeseriesQueryQueryToolChest(null);", "modifier": "private static final", "type": "TimeseriesQueryQueryToolChest", "declarator": "TOOL_CHEST = new TimeseriesQueryQueryToolChest(null)", "var_name": "TOOL_CHEST"}, {"original_string": "private final boolean descending;", "modifier": "private final", "type": "boolean", "declarator": "descending", "var_name": "descending"}], "file": "processing/src/test/java/org/apache/druid/query/timeseries/TimeseriesQueryQueryToolChestTest.java"}, "test_case": {"identifier": "testResultArraySignatureWithTimestampResultField", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testResultArraySignatureWithTimestampResultField()\n  {\n    final TimeseriesQuery query =\n        Druids.newTimeseriesQueryBuilder()\n              .dataSource(\"dummy\")\n              .intervals(\"2000/3000\")\n              .descending(descending)\n              .granularity(Granularities.HOUR)\n              .aggregators(QueryRunnerTestHelper.COMMON_DOUBLE_AGGREGATORS)\n              .postAggregators(QueryRunnerTestHelper.CONSTANT)\n              .context(ImmutableMap.of(TimeseriesQuery.CTX_TIMESTAMP_RESULT_FIELD, TIMESTAMP_RESULT_FIELD_NAME))\n              .build();\n\n    Assert.assertEquals(\n        RowSignature.builder()\n                    .addTimeColumn()\n                    .add(TIMESTAMP_RESULT_FIELD_NAME, ValueType.LONG)\n                    .add(\"rows\", ValueType.LONG)\n                    .add(\"index\", ValueType.DOUBLE)\n                    .add(\"uniques\", null)\n                    .add(\"const\", ValueType.LONG)\n                    .build(),\n        TOOL_CHEST.resultArraySignature(query)\n    );\n  }", "signature": "void testResultArraySignatureWithTimestampResultField()", "full_signature": "@Test public void testResultArraySignatureWithTimestampResultField()", "class_method_signature": "TimeseriesQueryQueryToolChestTest.testResultArraySignatureWithTimestampResultField()", "testcase": true, "constructor": false, "invocations": ["build", "context", "postAggregators", "aggregators", "granularity", "descending", "intervals", "dataSource", "newTimeseriesQueryBuilder", "of", "assertEquals", "build", "add", "add", "add", "add", "add", "addTimeColumn", "builder", "resultArraySignature"]}, "focal_class": {"identifier": "TimeseriesQueryQueryToolChest", "superclass": "extends QueryToolChest<Result<TimeseriesResultValue>, TimeseriesQuery>", "interfaces": "", "fields": [{"original_string": "private static final byte TIMESERIES_QUERY = 0x0;", "modifier": "private static final", "type": "byte", "declarator": "TIMESERIES_QUERY = 0x0", "var_name": "TIMESERIES_QUERY"}, {"original_string": "private static final TypeReference<Object> OBJECT_TYPE_REFERENCE =\n      new TypeReference<Object>()\n      {\n      };", "modifier": "private static final", "type": "TypeReference<Object>", "declarator": "OBJECT_TYPE_REFERENCE =\n      new TypeReference<Object>()\n      {\n      }", "var_name": "OBJECT_TYPE_REFERENCE"}, {"original_string": "private static final TypeReference<Result<TimeseriesResultValue>> TYPE_REFERENCE =\n      new TypeReference<Result<TimeseriesResultValue>>()\n      {\n      };", "modifier": "private static final", "type": "TypeReference<Result<TimeseriesResultValue>>", "declarator": "TYPE_REFERENCE =\n      new TypeReference<Result<TimeseriesResultValue>>()\n      {\n      }", "var_name": "TYPE_REFERENCE"}, {"original_string": "private final TimeseriesQueryMetricsFactory queryMetricsFactory;", "modifier": "private final", "type": "TimeseriesQueryMetricsFactory", "declarator": "queryMetricsFactory", "var_name": "queryMetricsFactory"}], "methods": [{"identifier": "TimeseriesQueryQueryToolChest", "parameters": "()", "modifiers": "@VisibleForTesting public", "return": "", "signature": " TimeseriesQueryQueryToolChest()", "full_signature": "@VisibleForTesting public  TimeseriesQueryQueryToolChest()", "class_method_signature": "TimeseriesQueryQueryToolChest.TimeseriesQueryQueryToolChest()", "testcase": false, "constructor": true}, {"identifier": "TimeseriesQueryQueryToolChest", "parameters": "(TimeseriesQueryMetricsFactory queryMetricsFactory)", "modifiers": "@Inject public", "return": "", "signature": " TimeseriesQueryQueryToolChest(TimeseriesQueryMetricsFactory queryMetricsFactory)", "full_signature": "@Inject public  TimeseriesQueryQueryToolChest(TimeseriesQueryMetricsFactory queryMetricsFactory)", "class_method_signature": "TimeseriesQueryQueryToolChest.TimeseriesQueryQueryToolChest(TimeseriesQueryMetricsFactory queryMetricsFactory)", "testcase": false, "constructor": true}, {"identifier": "mergeResults", "parameters": "(\n      QueryRunner<Result<TimeseriesResultValue>> queryRunner\n  )", "modifiers": "@Override public", "return": "QueryRunner<Result<TimeseriesResultValue>>", "signature": "QueryRunner<Result<TimeseriesResultValue>> mergeResults(\n      QueryRunner<Result<TimeseriesResultValue>> queryRunner\n  )", "full_signature": "@Override public QueryRunner<Result<TimeseriesResultValue>> mergeResults(\n      QueryRunner<Result<TimeseriesResultValue>> queryRunner\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.mergeResults(\n      QueryRunner<Result<TimeseriesResultValue>> queryRunner\n  )", "testcase": false, "constructor": false}, {"identifier": "createMergeFn", "parameters": "(\n      Query<Result<TimeseriesResultValue>> query\n  )", "modifiers": "@Override public", "return": "BinaryOperator<Result<TimeseriesResultValue>>", "signature": "BinaryOperator<Result<TimeseriesResultValue>> createMergeFn(\n      Query<Result<TimeseriesResultValue>> query\n  )", "full_signature": "@Override public BinaryOperator<Result<TimeseriesResultValue>> createMergeFn(\n      Query<Result<TimeseriesResultValue>> query\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.createMergeFn(\n      Query<Result<TimeseriesResultValue>> query\n  )", "testcase": false, "constructor": false}, {"identifier": "createResultComparator", "parameters": "(Query<Result<TimeseriesResultValue>> query)", "modifiers": "@Override public", "return": "Comparator<Result<TimeseriesResultValue>>", "signature": "Comparator<Result<TimeseriesResultValue>> createResultComparator(Query<Result<TimeseriesResultValue>> query)", "full_signature": "@Override public Comparator<Result<TimeseriesResultValue>> createResultComparator(Query<Result<TimeseriesResultValue>> query)", "class_method_signature": "TimeseriesQueryQueryToolChest.createResultComparator(Query<Result<TimeseriesResultValue>> query)", "testcase": false, "constructor": false}, {"identifier": "getNullTimeseriesResultValue", "parameters": "(TimeseriesQuery query)", "modifiers": "private", "return": "Result<TimeseriesResultValue>", "signature": "Result<TimeseriesResultValue> getNullTimeseriesResultValue(TimeseriesQuery query)", "full_signature": "private Result<TimeseriesResultValue> getNullTimeseriesResultValue(TimeseriesQuery query)", "class_method_signature": "TimeseriesQueryQueryToolChest.getNullTimeseriesResultValue(TimeseriesQuery query)", "testcase": false, "constructor": false}, {"identifier": "makeMetrics", "parameters": "(TimeseriesQuery query)", "modifiers": "@Override public", "return": "TimeseriesQueryMetrics", "signature": "TimeseriesQueryMetrics makeMetrics(TimeseriesQuery query)", "full_signature": "@Override public TimeseriesQueryMetrics makeMetrics(TimeseriesQuery query)", "class_method_signature": "TimeseriesQueryQueryToolChest.makeMetrics(TimeseriesQuery query)", "testcase": false, "constructor": false}, {"identifier": "getResultTypeReference", "parameters": "()", "modifiers": "@Override public", "return": "TypeReference<Result<TimeseriesResultValue>>", "signature": "TypeReference<Result<TimeseriesResultValue>> getResultTypeReference()", "full_signature": "@Override public TypeReference<Result<TimeseriesResultValue>> getResultTypeReference()", "class_method_signature": "TimeseriesQueryQueryToolChest.getResultTypeReference()", "testcase": false, "constructor": false}, {"identifier": "getCacheStrategy", "parameters": "(final TimeseriesQuery query)", "modifiers": "@Override public", "return": "CacheStrategy<Result<TimeseriesResultValue>, Object, TimeseriesQuery>", "signature": "CacheStrategy<Result<TimeseriesResultValue>, Object, TimeseriesQuery> getCacheStrategy(final TimeseriesQuery query)", "full_signature": "@Override public CacheStrategy<Result<TimeseriesResultValue>, Object, TimeseriesQuery> getCacheStrategy(final TimeseriesQuery query)", "class_method_signature": "TimeseriesQueryQueryToolChest.getCacheStrategy(final TimeseriesQuery query)", "testcase": false, "constructor": false}, {"identifier": "preMergeQueryDecoration", "parameters": "(final QueryRunner<Result<TimeseriesResultValue>> runner)", "modifiers": "@Override public", "return": "QueryRunner<Result<TimeseriesResultValue>>", "signature": "QueryRunner<Result<TimeseriesResultValue>> preMergeQueryDecoration(final QueryRunner<Result<TimeseriesResultValue>> runner)", "full_signature": "@Override public QueryRunner<Result<TimeseriesResultValue>> preMergeQueryDecoration(final QueryRunner<Result<TimeseriesResultValue>> runner)", "class_method_signature": "TimeseriesQueryQueryToolChest.preMergeQueryDecoration(final QueryRunner<Result<TimeseriesResultValue>> runner)", "testcase": false, "constructor": false}, {"identifier": "makePreComputeManipulatorFn", "parameters": "(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn\n  )", "modifiers": "@Override public", "return": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>>", "signature": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makePreComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn\n  )", "full_signature": "@Override public Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makePreComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.makePreComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn\n  )", "testcase": false, "constructor": false}, {"identifier": "makePostComputeManipulatorFn", "parameters": "(\n      TimeseriesQuery query,\n      MetricManipulationFn fn\n  )", "modifiers": "@Override public", "return": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>>", "signature": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makePostComputeManipulatorFn(\n      TimeseriesQuery query,\n      MetricManipulationFn fn\n  )", "full_signature": "@Override public Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makePostComputeManipulatorFn(\n      TimeseriesQuery query,\n      MetricManipulationFn fn\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.makePostComputeManipulatorFn(\n      TimeseriesQuery query,\n      MetricManipulationFn fn\n  )", "testcase": false, "constructor": false}, {"identifier": "resultArraySignature", "parameters": "(TimeseriesQuery query)", "modifiers": "@Override public", "return": "RowSignature", "signature": "RowSignature resultArraySignature(TimeseriesQuery query)", "full_signature": "@Override public RowSignature resultArraySignature(TimeseriesQuery query)", "class_method_signature": "TimeseriesQueryQueryToolChest.resultArraySignature(TimeseriesQuery query)", "testcase": false, "constructor": false}, {"identifier": "resultsAsArrays", "parameters": "(\n      final TimeseriesQuery query,\n      final Sequence<Result<TimeseriesResultValue>> resultSequence\n  )", "modifiers": "@Override public", "return": "Sequence<Object[]>", "signature": "Sequence<Object[]> resultsAsArrays(\n      final TimeseriesQuery query,\n      final Sequence<Result<TimeseriesResultValue>> resultSequence\n  )", "full_signature": "@Override public Sequence<Object[]> resultsAsArrays(\n      final TimeseriesQuery query,\n      final Sequence<Result<TimeseriesResultValue>> resultSequence\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.resultsAsArrays(\n      final TimeseriesQuery query,\n      final Sequence<Result<TimeseriesResultValue>> resultSequence\n  )", "testcase": false, "constructor": false}, {"identifier": "makeComputeManipulatorFn", "parameters": "(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn,\n      final boolean calculatePostAggs\n  )", "modifiers": "private", "return": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>>", "signature": "Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makeComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn,\n      final boolean calculatePostAggs\n  )", "full_signature": "private Function<Result<TimeseriesResultValue>, Result<TimeseriesResultValue>> makeComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn,\n      final boolean calculatePostAggs\n  )", "class_method_signature": "TimeseriesQueryQueryToolChest.makeComputeManipulatorFn(\n      final TimeseriesQuery query,\n      final MetricManipulationFn fn,\n      final boolean calculatePostAggs\n  )", "testcase": false, "constructor": false}], "file": "processing/src/main/java/org/apache/druid/query/timeseries/TimeseriesQueryQueryToolChest.java"}, "focal_method": {"identifier": "resultArraySignature", "parameters": "(TimeseriesQuery query)", "modifiers": "@Override public", "return": "RowSignature", "body": "@Override\n  public RowSignature resultArraySignature(TimeseriesQuery query)\n  {\n    RowSignature.Builder rowSignatureBuilder = RowSignature.builder();\n    rowSignatureBuilder.addTimeColumn();\n    if (StringUtils.isNotEmpty(query.getTimestampResultField())) {\n      rowSignatureBuilder.add(query.getTimestampResultField(), ValueType.LONG);\n    }\n    rowSignatureBuilder.addAggregators(query.getAggregatorSpecs());\n    rowSignatureBuilder.addPostAggregators(query.getPostAggregatorSpecs());\n    return rowSignatureBuilder.build();\n  }", "signature": "RowSignature resultArraySignature(TimeseriesQuery query)", "full_signature": "@Override public RowSignature resultArraySignature(TimeseriesQuery query)", "class_method_signature": "TimeseriesQueryQueryToolChest.resultArraySignature(TimeseriesQuery query)", "testcase": false, "constructor": false, "invocations": ["builder", "addTimeColumn", "isNotEmpty", "getTimestampResultField", "add", "getTimestampResultField", "addAggregators", "getAggregatorSpecs", "addPostAggregators", "getPostAggregatorSpecs", "build"]}, "repository": {"repo_id": 6358188, "url": "https://github.com/apache/druid", "stars": 9116, "created": "10/23/2012 7:08:07 PM +00:00", "updates": "2020-01-27T21:36:20+00:00", "fork": "False", "license": "licensed"}}