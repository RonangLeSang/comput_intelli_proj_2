{"test_class": {"identifier": "CopySchemaTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Inject\n    private CoreSession session;", "modifier": "@Inject\n    private", "type": "CoreSession", "declarator": "session", "var_name": "session"}, {"original_string": "@Inject\n    private AutomationService service;", "modifier": "@Inject\n    private", "type": "AutomationService", "declarator": "service", "var_name": "service"}, {"original_string": "private DocumentModel source;", "modifier": "private", "type": "DocumentModel", "declarator": "source", "var_name": "source"}, {"original_string": "private DocumentModel target1;", "modifier": "private", "type": "DocumentModel", "declarator": "target1", "var_name": "target1"}, {"original_string": "private DocumentModel target2;", "modifier": "private", "type": "DocumentModel", "declarator": "target2", "var_name": "target2"}, {"original_string": "private DocumentModelList targets;", "modifier": "private", "type": "DocumentModelList", "declarator": "targets", "var_name": "targets"}, {"original_string": "protected OperationContext context;", "modifier": "protected", "type": "OperationContext", "declarator": "context", "var_name": "context"}], "file": "modules/platform/nuxeo-automation/nuxeo-automation-core/src/test/java/org/nuxeo/ecm/automation/core/operations/document/CopySchemaTest.java"}, "test_case": {"identifier": "shouldNotSaveTheDocument", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void shouldNotSaveTheDocument() throws Exception {\n\n        source.setPropertyValue(\"common:icon-expanded\", \"icon-expanded-source\");\n        source = session.saveDocument(source);\n\n        target1.setPropertyValue(\"common:icon-expanded\", \"icon-expanded-target1\");\n        target1 = session.saveDocument(target1);\n\n        context.setInput(target1);\n        OperationChain chain = new OperationChain(\"testSaveParameters_1\");\n        chain.add(CopySchema.ID).set(\"sourceId\", source.getId()).set(\"schema\", \"common\").set(\"saveDocument\", false);\n        service.run(context, chain);\n\n        String value = (String) target1.getPropertyValue(\"common:icon-expanded\");\n        assertEquals(\"icon-expanded-source\", value);\n\n        target1.refresh();\n        value = (String) target1.getPropertyValue(\"common:icon-expanded\");\n        assertEquals(\"icon-expanded-target1\", value);\n    }", "signature": "void shouldNotSaveTheDocument()", "full_signature": "@Test public void shouldNotSaveTheDocument()", "class_method_signature": "CopySchemaTest.shouldNotSaveTheDocument()", "testcase": true, "constructor": false, "invocations": ["setPropertyValue", "saveDocument", "setPropertyValue", "saveDocument", "setInput", "set", "set", "set", "add", "getId", "run", "getPropertyValue", "assertEquals", "refresh", "getPropertyValue", "assertEquals"]}, "focal_class": {"identifier": "CopySchema", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String ID = \"Document.CopySchema\";", "modifier": "public static final", "type": "String", "declarator": "ID = \"Document.CopySchema\"", "var_name": "ID"}, {"original_string": "@Context\n    protected OperationContext context;", "modifier": "@Context\n    protected", "type": "OperationContext", "declarator": "context", "var_name": "context"}, {"original_string": "@Context\n    protected CoreSession session;", "modifier": "@Context\n    protected", "type": "CoreSession", "declarator": "session", "var_name": "session"}, {"original_string": "@Param(name = \"schema\")\n    protected String schema;", "modifier": "@Param(name = \"schema\")\n    protected", "type": "String", "declarator": "schema", "var_name": "schema"}, {"original_string": "@Param(name = \"sourceId\", required = false)\n    protected String sourceId;", "modifier": "@Param(name = \"sourceId\", required = false)\n    protected", "type": "String", "declarator": "sourceId", "var_name": "sourceId"}, {"original_string": "@Param(name = \"sourcePath\", required = false)\n    protected String sourcePath;", "modifier": "@Param(name = \"sourcePath\", required = false)\n    protected", "type": "String", "declarator": "sourcePath", "var_name": "sourcePath"}, {"original_string": "@Param(name = \"save\", required = false, values = { \"true\" })\n    protected boolean save = true;", "modifier": "@Param(name = \"save\", required = false, values = { \"true\" })\n    protected", "type": "boolean", "declarator": "save = true", "var_name": "save"}, {"original_string": "@Param(name = \"saveDocument\", required = false, values = { \"true\" })\n    protected boolean saveDocument = true;", "modifier": "@Param(name = \"saveDocument\", required = false, values = { \"true\" })\n    protected", "type": "boolean", "declarator": "saveDocument = true", "var_name": "saveDocument"}], "methods": [{"identifier": "getDocumentFromIdOrPath", "parameters": "()", "modifiers": "private", "return": "DocumentModel", "signature": "DocumentModel getDocumentFromIdOrPath()", "full_signature": "private DocumentModel getDocumentFromIdOrPath()", "class_method_signature": "CopySchema.getDocumentFromIdOrPath()", "testcase": false, "constructor": false}, {"identifier": "copySchemaProperties", "parameters": "(DocumentModel source, DocumentModel target)", "modifiers": "private", "return": "void", "signature": "void copySchemaProperties(DocumentModel source, DocumentModel target)", "full_signature": "private void copySchemaProperties(DocumentModel source, DocumentModel target)", "class_method_signature": "CopySchema.copySchemaProperties(DocumentModel source, DocumentModel target)", "testcase": false, "constructor": false}, {"identifier": "run", "parameters": "(DocumentModel target)", "modifiers": "@OperationMethod(collector = DocumentModelCollector.class) public", "return": "DocumentModel", "signature": "DocumentModel run(DocumentModel target)", "full_signature": "@OperationMethod(collector = DocumentModelCollector.class) public DocumentModel run(DocumentModel target)", "class_method_signature": "CopySchema.run(DocumentModel target)", "testcase": false, "constructor": false}], "file": "modules/platform/nuxeo-automation/nuxeo-automation-core/src/main/java/org/nuxeo/ecm/automation/core/operations/document/CopySchema.java"}, "focal_method": {"identifier": "run", "parameters": "(DocumentModel target)", "modifiers": "@OperationMethod(collector = DocumentModelCollector.class) public", "return": "DocumentModel", "body": "@OperationMethod(collector = DocumentModelCollector.class)\n    public DocumentModel run(DocumentModel target) throws OperationException {\n        DocumentModel source = getDocumentFromIdOrPath();\n        copySchemaProperties(source, target);\n\n        if (saveDocument) {\n            target = session.saveDocument(target);\n            if (save) {\n                session.save();\n            }\n        }\n        return target;\n    }", "signature": "DocumentModel run(DocumentModel target)", "full_signature": "@OperationMethod(collector = DocumentModelCollector.class) public DocumentModel run(DocumentModel target)", "class_method_signature": "CopySchema.run(DocumentModel target)", "testcase": false, "constructor": false, "invocations": ["getDocumentFromIdOrPath", "copySchemaProperties", "saveDocument", "save"]}, "repository": {"repo_id": 2988101, "url": "https://github.com/nuxeo/nuxeo", "stars": 339, "created": "12/15/2011 2:35:41 PM +00:00", "updates": "2020-01-27T16:52:27+00:00", "fork": "False", "license": "licensed"}}