{"test_class": {"identifier": "BulkIndexWriterTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final Span STABLE_SPAN = CLIENT_SPAN.toBuilder()\n    .timestamp(100)\n    .clearAnnotations()\n    .build();", "modifier": "static final", "type": "Span", "declarator": "STABLE_SPAN = CLIENT_SPAN.toBuilder()\n    .timestamp(100)\n    .clearAnnotations()\n    .build()", "var_name": "STABLE_SPAN"}, {"original_string": "ByteBufOutputStream buffer;", "modifier": "", "type": "ByteBufOutputStream", "declarator": "buffer", "var_name": "buffer"}], "file": "zipkin-storage/elasticsearch/src/test/java/zipkin2/elasticsearch/internal/BulkIndexWriterTest.java"}, "test_case": {"identifier": "spanSearchFields_addsTimestampFieldWhenNoTags", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test public void spanSearchFields_addsTimestampFieldWhenNoTags() {\n    Span span =\n      Span.newBuilder()\n        .traceId(\"20\")\n        .id(\"22\")\n        .name(\"\")\n        .parentId(\"21\")\n        .timestamp(1000L)\n        .localEndpoint(FRONTEND)\n        .kind(Kind.CLIENT)\n        .build();\n\n    BulkIndexWriter.SPAN.writeDocument(span, buffer);\n\n    assertThat(buffer.buffer().toString(StandardCharsets.UTF_8))\n      .startsWith(\"{\\\"timestamp_millis\\\":1,\\\"traceId\\\":\");\n  }", "signature": "void spanSearchFields_addsTimestampFieldWhenNoTags()", "full_signature": "@Test public void spanSearchFields_addsTimestampFieldWhenNoTags()", "class_method_signature": "BulkIndexWriterTest.spanSearchFields_addsTimestampFieldWhenNoTags()", "testcase": true, "constructor": false, "invocations": ["build", "kind", "localEndpoint", "timestamp", "parentId", "name", "id", "traceId", "newBuilder", "writeDocument", "startsWith", "assertThat", "toString", "buffer"]}, "focal_class": {"identifier": "BulkIndexWriter", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final BulkIndexWriter<Span> SPAN = new BulkIndexWriter<Span>() {\n    @Override public String writeDocument(Span input, ByteBufOutputStream sink) {\n      return write(input, true, sink);\n    }\n  };", "modifier": "public static final", "type": "BulkIndexWriter<Span>", "declarator": "SPAN = new BulkIndexWriter<Span>() {\n    @Override public String writeDocument(Span input, ByteBufOutputStream sink) {\n      return write(input, true, sink);\n    }\n  }", "var_name": "SPAN"}, {"original_string": "public static final BulkIndexWriter<Span>\n    SPAN_SEARCH_DISABLED = new BulkIndexWriter<Span>() {\n    @Override public String writeDocument(Span input, ByteBufOutputStream sink) {\n      return write(input, false, sink);\n    }\n  };", "modifier": "public static final", "type": "BulkIndexWriter<Span>", "declarator": "SPAN_SEARCH_DISABLED = new BulkIndexWriter<Span>() {\n    @Override public String writeDocument(Span input, ByteBufOutputStream sink) {\n      return write(input, false, sink);\n    }\n  }", "var_name": "SPAN_SEARCH_DISABLED"}, {"original_string": "public static final BulkIndexWriter<Map.Entry<String, String>> AUTOCOMPLETE =\n    new BulkIndexWriter<Map.Entry<String, String>>() {\n      @Override public String writeDocument(Map.Entry<String, String> input,\n        ByteBufOutputStream sink) {\n        try (JsonGenerator writer = JsonSerializers.jsonGenerator(sink)) {\n          writeAutocompleteEntry(input.getKey(), input.getValue(), writer);\n        } catch (IOException e) {\n          throw new AssertionError(\"Couldn't close generator for a memory stream.\", e);\n        }\n        // Id is used to dedupe server side as necessary. Arbitrarily same format as _q value.\n        return input.getKey() + '=' + input.getValue();\n      }\n    };", "modifier": "public static final", "type": "BulkIndexWriter<Map.Entry<String, String>>", "declarator": "AUTOCOMPLETE =\n    new BulkIndexWriter<Map.Entry<String, String>>() {\n      @Override public String writeDocument(Map.Entry<String, String> input,\n        ByteBufOutputStream sink) {\n        try (JsonGenerator writer = JsonSerializers.jsonGenerator(sink)) {\n          writeAutocompleteEntry(input.getKey(), input.getValue(), writer);\n        } catch (IOException e) {\n          throw new AssertionError(\"Couldn't close generator for a memory stream.\", e);\n        }\n        // Id is used to dedupe server side as necessary. Arbitrarily same format as _q value.\n        return input.getKey() + '=' + input.getValue();\n      }\n    }", "var_name": "AUTOCOMPLETE"}, {"original_string": "static final Endpoint EMPTY_ENDPOINT = Endpoint.newBuilder().build();", "modifier": "static final", "type": "Endpoint", "declarator": "EMPTY_ENDPOINT = Endpoint.newBuilder().build()", "var_name": "EMPTY_ENDPOINT"}], "methods": [{"identifier": "writeDocument", "parameters": "(T input, ByteBufOutputStream sink)", "modifiers": "public abstract", "return": "String", "signature": "String writeDocument(T input, ByteBufOutputStream sink)", "full_signature": "public abstract String writeDocument(T input, ByteBufOutputStream sink)", "class_method_signature": "BulkIndexWriter.writeDocument(T input, ByteBufOutputStream sink)", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(Span span, boolean searchEnabled, ByteBufOutputStream sink)", "modifiers": "static", "return": "String", "signature": "String write(Span span, boolean searchEnabled, ByteBufOutputStream sink)", "full_signature": "static String write(Span span, boolean searchEnabled, ByteBufOutputStream sink)", "class_method_signature": "BulkIndexWriter.write(Span span, boolean searchEnabled, ByteBufOutputStream sink)", "testcase": false, "constructor": false}, {"identifier": "writeAutocompleteEntry", "parameters": "(String key, String value, JsonGenerator writer)", "modifiers": "static", "return": "void", "signature": "void writeAutocompleteEntry(String key, String value, JsonGenerator writer)", "full_signature": "static void writeAutocompleteEntry(String key, String value, JsonGenerator writer)", "class_method_signature": "BulkIndexWriter.writeAutocompleteEntry(String key, String value, JsonGenerator writer)", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(Map.Entry<String, String> tag, JsonGenerator writer)", "modifiers": "static", "return": "void", "signature": "void write(Map.Entry<String, String> tag, JsonGenerator writer)", "full_signature": "static void write(Map.Entry<String, String> tag, JsonGenerator writer)", "class_method_signature": "BulkIndexWriter.write(Map.Entry<String, String> tag, JsonGenerator writer)", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(Annotation annotation, JsonGenerator writer)", "modifiers": "static", "return": "void", "signature": "void write(Annotation annotation, JsonGenerator writer)", "full_signature": "static void write(Annotation annotation, JsonGenerator writer)", "class_method_signature": "BulkIndexWriter.write(Annotation annotation, JsonGenerator writer)", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(Endpoint endpoint, JsonGenerator writer)", "modifiers": "static", "return": "void", "signature": "void write(Endpoint endpoint, JsonGenerator writer)", "full_signature": "static void write(Endpoint endpoint, JsonGenerator writer)", "class_method_signature": "BulkIndexWriter.write(Endpoint endpoint, JsonGenerator writer)", "testcase": false, "constructor": false}, {"identifier": "addSearchFields", "parameters": "(Span span, JsonGenerator writer)", "modifiers": "static", "return": "void", "signature": "void addSearchFields(Span span, JsonGenerator writer)", "full_signature": "static void addSearchFields(Span span, JsonGenerator writer)", "class_method_signature": "BulkIndexWriter.addSearchFields(Span span, JsonGenerator writer)", "testcase": false, "constructor": false}, {"identifier": "md5", "parameters": "(ByteBuf buf)", "modifiers": "static", "return": "String", "signature": "String md5(ByteBuf buf)", "full_signature": "static String md5(ByteBuf buf)", "class_method_signature": "BulkIndexWriter.md5(ByteBuf buf)", "testcase": false, "constructor": false}], "file": "zipkin-storage/elasticsearch/src/main/java/zipkin2/elasticsearch/internal/BulkIndexWriter.java"}, "focal_method": {"identifier": "writeDocument", "parameters": "(T input, ByteBufOutputStream sink)", "modifiers": "public abstract", "return": "String", "body": "public abstract String writeDocument(T input, ByteBufOutputStream sink);", "signature": "String writeDocument(T input, ByteBufOutputStream sink)", "full_signature": "public abstract String writeDocument(T input, ByteBufOutputStream sink)", "class_method_signature": "BulkIndexWriter.writeDocument(T input, ByteBufOutputStream sink)", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 4576305, "url": "https://github.com/openzipkin/zipkin", "stars": 12365, "created": "6/6/2012 6:26:16 PM +00:00", "updates": "2020-01-27T10:22:48+00:00", "fork": "False", "license": "licensed"}}