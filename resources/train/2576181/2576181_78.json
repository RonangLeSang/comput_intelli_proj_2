{"test_class": {"identifier": "PirasoContextTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String MONITORED_ADDR = \"127.0.0.1\";", "modifier": "public static final", "type": "String", "declarator": "MONITORED_ADDR = \"127.0.0.1\"", "var_name": "MONITORED_ADDR"}, {"original_string": "private UserRegistry registry;", "modifier": "private", "type": "UserRegistry", "declarator": "registry", "var_name": "registry"}, {"original_string": "private MockHttpServletRequest request;", "modifier": "private", "type": "MockHttpServletRequest", "declarator": "request", "var_name": "request"}, {"original_string": "private TestPirasoRequest pirasoRequest;", "modifier": "private", "type": "TestPirasoRequest", "declarator": "pirasoRequest", "var_name": "pirasoRequest"}, {"original_string": "private PirasoContext context;", "modifier": "private", "type": "PirasoContext", "declarator": "context", "var_name": "context"}], "file": "context-logger/server/src/test/java/org/piraso/server/PirasoContextTest.java"}, "test_case": {"identifier": "testLogNullProperty", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testLogNullProperty() throws Exception {\n        User user = associateUser(request);\n\n        MockHttpServletRequest request2 = mockRequest(MONITORED_ADDR);\n        User user2 = associateUser(request2);\n\n        GroupChainId id = new GroupChainId(\"test\");\n        MessageEntry entry = new MessageEntry(\"test\");\n\n        context.log(null, id, entry);\n\n        verify(registry.getLogger(user), times(1)).log(entry);\n        verify(registry.getLogger(user2), times(1)).log(entry);\n    }", "signature": "void testLogNullProperty()", "full_signature": "@Test public void testLogNullProperty()", "class_method_signature": "PirasoContextTest.testLogNullProperty()", "testcase": true, "constructor": false, "invocations": ["associateUser", "mockRequest", "associateUser", "log", "log", "verify", "getLogger", "times", "log", "verify", "getLogger", "times"]}, "focal_class": {"identifier": "PirasoContext", "superclass": "", "interfaces": "implements ContextPreference", "fields": [{"original_string": "private static final Log LOG = LogFactory.getLog(PirasoContext.class);", "modifier": "private static final", "type": "Log", "declarator": "LOG = LogFactory.getLog(PirasoContext.class)", "var_name": "LOG"}, {"original_string": "private static final Log LOG_ENTRY_POINT = PirasoLogger.getEntryPoint();", "modifier": "private static final", "type": "Log", "declarator": "LOG_ENTRY_POINT = PirasoLogger.getEntryPoint()", "var_name": "LOG_ENTRY_POINT"}, {"original_string": "public static final String INDENT_PROPERTY = \"indent\";", "modifier": "public static final", "type": "String", "declarator": "INDENT_PROPERTY = \"indent\"", "var_name": "INDENT_PROPERTY"}, {"original_string": "private LoggerRegistry registry;", "modifier": "private", "type": "LoggerRegistry", "declarator": "registry", "var_name": "registry"}, {"original_string": "private PirasoEntryPoint entryPoint;", "modifier": "private", "type": "PirasoEntryPoint", "declarator": "entryPoint", "var_name": "entryPoint"}, {"original_string": "private long requestId;", "modifier": "private", "type": "long", "declarator": "requestId", "var_name": "requestId"}, {"original_string": "private ReferenceRequestEntry ref;", "modifier": "private", "type": "ReferenceRequestEntry", "declarator": "ref", "var_name": "ref"}, {"original_string": "private Map<Class<?>, Map<String, Object>> propertyBag = new HashMap<Class<?>, Map<String, Object>>();", "modifier": "private", "type": "Map<Class<?>, Map<String, Object>>", "declarator": "propertyBag = new HashMap<Class<?>, Map<String, Object>>()", "var_name": "propertyBag"}, {"original_string": "private LinkedList<EntryHolder> scopedEntryQueue = new LinkedList<EntryHolder>();", "modifier": "private", "type": "LinkedList<EntryHolder>", "declarator": "scopedEntryQueue = new LinkedList<EntryHolder>()", "var_name": "scopedEntryQueue"}, {"original_string": "private List<ResponseLoggerService> requestScoped = Collections.synchronizedList(new LinkedList<ResponseLoggerService>());", "modifier": "private", "type": "List<ResponseLoggerService>", "declarator": "requestScoped = Collections.synchronizedList(new LinkedList<ResponseLoggerService>())", "var_name": "requestScoped"}, {"original_string": "private GroupChainId refGroupChainId;", "modifier": "private", "type": "GroupChainId", "declarator": "refGroupChainId", "var_name": "refGroupChainId"}], "methods": [{"identifier": "PirasoContext", "parameters": "(PirasoEntryPoint entryPoint)", "modifiers": "public", "return": "", "signature": " PirasoContext(PirasoEntryPoint entryPoint)", "full_signature": "public  PirasoContext(PirasoEntryPoint entryPoint)", "class_method_signature": "PirasoContext.PirasoContext(PirasoEntryPoint entryPoint)", "testcase": false, "constructor": true}, {"identifier": "PirasoContext", "parameters": "(PirasoEntryPoint entryPoint, LoggerRegistry registry)", "modifiers": "public", "return": "", "signature": " PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry)", "full_signature": "public  PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry)", "class_method_signature": "PirasoContext.PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry)", "testcase": false, "constructor": true}, {"identifier": "PirasoContext", "parameters": "(PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref)", "modifiers": "public", "return": "", "signature": " PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref)", "full_signature": "public  PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref)", "class_method_signature": "PirasoContext.PirasoContext(PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref)", "testcase": false, "constructor": true}, {"identifier": "PirasoContext", "parameters": "(long requestId, PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref, GroupChainId refGroupChainId)", "modifiers": "private", "return": "", "signature": " PirasoContext(long requestId, PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref, GroupChainId refGroupChainId)", "full_signature": "private  PirasoContext(long requestId, PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref, GroupChainId refGroupChainId)", "class_method_signature": "PirasoContext.PirasoContext(long requestId, PirasoEntryPoint entryPoint, LoggerRegistry registry, ReferenceRequestEntry ref, GroupChainId refGroupChainId)", "testcase": false, "constructor": true}, {"identifier": "createChildContext", "parameters": "(GroupChainId chainId)", "modifiers": "public", "return": "PirasoContext", "signature": "PirasoContext createChildContext(GroupChainId chainId)", "full_signature": "public PirasoContext createChildContext(GroupChainId chainId)", "class_method_signature": "PirasoContext.createChildContext(GroupChainId chainId)", "testcase": false, "constructor": false}, {"identifier": "setIndent", "parameters": "(int indent)", "modifiers": "public", "return": "void", "signature": "void setIndent(int indent)", "full_signature": "public void setIndent(int indent)", "class_method_signature": "PirasoContext.setIndent(int indent)", "testcase": false, "constructor": false}, {"identifier": "getIndent", "parameters": "()", "modifiers": "public", "return": "int", "signature": "int getIndent()", "full_signature": "public int getIndent()", "class_method_signature": "PirasoContext.getIndent()", "testcase": false, "constructor": false}, {"identifier": "addProperty", "parameters": "(Class<?> clazz, String name, Object value)", "modifiers": "public", "return": "void", "signature": "void addProperty(Class<?> clazz, String name, Object value)", "full_signature": "public void addProperty(Class<?> clazz, String name, Object value)", "class_method_signature": "PirasoContext.addProperty(Class<?> clazz, String name, Object value)", "testcase": false, "constructor": false}, {"identifier": "removeProperty", "parameters": "(Class<?> clazz, String name)", "modifiers": "public", "return": "void", "signature": "void removeProperty(Class<?> clazz, String name)", "full_signature": "public void removeProperty(Class<?> clazz, String name)", "class_method_signature": "PirasoContext.removeProperty(Class<?> clazz, String name)", "testcase": false, "constructor": false}, {"identifier": "getProperty", "parameters": "(Class<?> clazz, String name)", "modifiers": "public", "return": "Object", "signature": "Object getProperty(Class<?> clazz, String name)", "full_signature": "public Object getProperty(Class<?> clazz, String name)", "class_method_signature": "PirasoContext.getProperty(Class<?> clazz, String name)", "testcase": false, "constructor": false}, {"identifier": "getRequestId", "parameters": "()", "modifiers": "public", "return": "Long", "signature": "Long getRequestId()", "full_signature": "public Long getRequestId()", "class_method_signature": "PirasoContext.getRequestId()", "testcase": false, "constructor": false}, {"identifier": "getRef", "parameters": "()", "modifiers": "public", "return": "ReferenceRequestEntry", "signature": "ReferenceRequestEntry getRef()", "full_signature": "public ReferenceRequestEntry getRef()", "class_method_signature": "PirasoContext.getRef()", "testcase": false, "constructor": false}, {"identifier": "getEntryPoint", "parameters": "()", "modifiers": "public", "return": "PirasoEntryPoint", "signature": "PirasoEntryPoint getEntryPoint()", "full_signature": "public PirasoEntryPoint getEntryPoint()", "class_method_signature": "PirasoContext.getEntryPoint()", "testcase": false, "constructor": false}, {"identifier": "isMonitored", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isMonitored()", "full_signature": "public boolean isMonitored()", "class_method_signature": "PirasoContext.isMonitored()", "testcase": false, "constructor": false}, {"identifier": "isRegexEnabled", "parameters": "(String property)", "modifiers": "public", "return": "boolean", "signature": "boolean isRegexEnabled(String property)", "full_signature": "public boolean isRegexEnabled(String property)", "class_method_signature": "PirasoContext.isRegexEnabled(String property)", "testcase": false, "constructor": false}, {"identifier": "isEnabled", "parameters": "(String property)", "modifiers": "public", "return": "boolean", "signature": "boolean isEnabled(String property)", "full_signature": "public boolean isEnabled(String property)", "class_method_signature": "PirasoContext.isEnabled(String property)", "testcase": false, "constructor": false}, {"identifier": "getIntValue", "parameters": "(String property)", "modifiers": "public", "return": "Integer", "signature": "Integer getIntValue(String property)", "full_signature": "public Integer getIntValue(String property)", "class_method_signature": "PirasoContext.getIntValue(String property)", "testcase": false, "constructor": false}, {"identifier": "log", "parameters": "(Level level, GroupChainId id, Entry entry)", "modifiers": "public", "return": "void", "signature": "void log(Level level, GroupChainId id, Entry entry)", "full_signature": "public void log(Level level, GroupChainId id, Entry entry)", "class_method_signature": "PirasoContext.log(Level level, GroupChainId id, Entry entry)", "testcase": false, "constructor": false}, {"identifier": "doLog", "parameters": "(ResponseLoggerService logger, Level level, GroupChainId id, Entry entry)", "modifiers": "private", "return": "void", "signature": "void doLog(ResponseLoggerService logger, Level level, GroupChainId id, Entry entry)", "full_signature": "private void doLog(ResponseLoggerService logger, Level level, GroupChainId id, Entry entry)", "class_method_signature": "PirasoContext.doLog(ResponseLoggerService logger, Level level, GroupChainId id, Entry entry)", "testcase": false, "constructor": false}], "file": "context-logger/server/src/main/java/org/piraso/server/PirasoContext.java"}, "focal_method": {"identifier": "log", "parameters": "(Level level, GroupChainId id, Entry entry)", "modifiers": "public", "return": "void", "body": "public void log(Level level, GroupChainId id, Entry entry) {\n        // always store scoped entries\n        if(Level.SCOPED.equals(level)) {\n            scopedEntryQueue.add(new EntryHolder(id, entry));\n        }\n\n        if(!isMonitored()) {\n            // ignore any logs when current context is not monitored.\n            return;\n        }\n\n        if(level == null) {\n            level = Level.ALL;\n        }\n\n        try {\n            List<ResponseLoggerService> loggers = registry.getContextLoggers(entryPoint);\n\n            if(Level.SCOPED.equals(level)) {\n                for(ResponseLoggerService logger : loggers) {\n                    Preferences preferences = logger.getPreferences();\n\n                    synchronized (this) {\n                        if(requestScoped.contains(logger) || !preferences.isEnabled(GeneralPreferenceEnum.SCOPE_ENABLED.getPropertyName())) {\n                            doLog(logger, Level.SCOPED, id, entry);\n\n                            if(!requestScoped.contains(logger)) {\n                                logger.addStopListener(new StoppedLoggerHandler(logger));\n                                requestScoped.add(logger);\n                            }\n                        }\n                    }\n                }\n\n                return;\n            }\n\n            for(ResponseLoggerService logger : loggers) {\n                Preferences preferences = logger.getPreferences();\n\n                if(Level.ALL.equals(level)) {\n                    doLog(logger, level, id, entry);\n                } else if(RegexLevelEntryAware.class.isInstance(entry)) {\n                    if(preferences.isRegexEnabled(level.getName())) {\n                        doLog(logger, level, id, entry);\n                    }\n                } else if(preferences.isEnabled(level.getName())) {\n                    doLog(logger, level, id, entry);\n                }\n            }\n        } catch (Exception e) {\n            LOG.warn(e.getMessage(), e);\n        }\n    }", "signature": "void log(Level level, GroupChainId id, Entry entry)", "full_signature": "public void log(Level level, GroupChainId id, Entry entry)", "class_method_signature": "PirasoContext.log(Level level, GroupChainId id, Entry entry)", "testcase": false, "constructor": false, "invocations": ["equals", "add", "isMonitored", "getContextLoggers", "equals", "getPreferences", "contains", "isEnabled", "getPropertyName", "doLog", "contains", "addStopListener", "add", "getPreferences", "equals", "doLog", "isInstance", "isRegexEnabled", "getName", "doLog", "isEnabled", "getName", "doLog", "warn", "getMessage"]}, "repository": {"repo_id": 2576181, "url": "https://github.com/piraso/piraso", "language": "Java", "is_fork": false, "fork_count": 2, "stargazer_count": 7, "size": 39068, "license": "licensed"}}