{"test_class": {"identifier": "ResourceShapeFactoryTest", "superclass": "", "interfaces": "", "fields": [], "file": "oslc4j-core/src/test/java/org/eclipse/lyo/oslc4j/core/model/ResourceShapeFactoryTest.java"}, "test_case": {"identifier": "findSetterCollection", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void findSetterCollection()\n            throws NoSuchMethodException, OslcCoreMissingSetMethodException {\n        ResourceShapeFactory.validateSetMethodExists(Dummy.class, Dummy.class.getMethod(\"getValue\"));\n    }", "signature": "void findSetterCollection()", "full_signature": "@Test public void findSetterCollection()", "class_method_signature": "ResourceShapeFactoryTest.findSetterCollection()", "testcase": true, "constructor": false, "invocations": ["validateSetMethodExists", "getMethod"]}, "focal_class": {"identifier": "ResourceShapeFactory", "superclass": "", "interfaces": "", "fields": [{"original_string": "protected static final String METHOD_NAME_START_GET = \"get\";", "modifier": "protected static final", "type": "String", "declarator": "METHOD_NAME_START_GET = \"get\"", "var_name": "METHOD_NAME_START_GET"}, {"original_string": "protected static final String METHOD_NAME_START_IS  = \"is\";", "modifier": "protected static final", "type": "String", "declarator": "METHOD_NAME_START_IS  = \"is\"", "var_name": "METHOD_NAME_START_IS"}, {"original_string": "protected static final String METHOD_NAME_START_SET = \"set\";", "modifier": "protected static final", "type": "String", "declarator": "METHOD_NAME_START_SET = \"set\"", "var_name": "METHOD_NAME_START_SET"}, {"original_string": "protected static final int METHOD_NAME_START_GET_LENGTH = METHOD_NAME_START_GET.length();", "modifier": "protected static final", "type": "int", "declarator": "METHOD_NAME_START_GET_LENGTH = METHOD_NAME_START_GET.length()", "var_name": "METHOD_NAME_START_GET_LENGTH"}, {"original_string": "protected static final int METHOD_NAME_START_IS_LENGTH  = METHOD_NAME_START_IS.length();", "modifier": "protected static final", "type": "int", "declarator": "METHOD_NAME_START_IS_LENGTH  = METHOD_NAME_START_IS.length()", "var_name": "METHOD_NAME_START_IS_LENGTH"}, {"original_string": "protected static final Map<Class<?>, ValueType> CLASS_TO_VALUE_TYPE = new HashMap<Class<?>, ValueType>();", "modifier": "protected static final", "type": "Map<Class<?>, ValueType>", "declarator": "CLASS_TO_VALUE_TYPE = new HashMap<Class<?>, ValueType>()", "var_name": "CLASS_TO_VALUE_TYPE"}], "methods": [{"identifier": "ResourceShapeFactory", "parameters": "()", "modifiers": "protected", "return": "", "signature": " ResourceShapeFactory()", "full_signature": "protected  ResourceShapeFactory()", "class_method_signature": "ResourceShapeFactory.ResourceShapeFactory()", "testcase": false, "constructor": true}, {"identifier": "createResourceShape", "parameters": "(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass)", "modifiers": "public static", "return": "ResourceShape", "signature": "ResourceShape createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass)", "full_signature": "public static ResourceShape createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass)", "class_method_signature": "ResourceShapeFactory.createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass)", "testcase": false, "constructor": false}, {"identifier": "createResourceShape", "parameters": "(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Set<Class<?>> verifiedClasses)", "modifiers": "private static", "return": "ResourceShape", "signature": "ResourceShape createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Set<Class<?>> verifiedClasses)", "full_signature": "private static ResourceShape createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Set<Class<?>> verifiedClasses)", "class_method_signature": "ResourceShapeFactory.createResourceShape(final String baseURI,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapesPath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal String resourceShapePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Class<?> resourceClass,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Set<Class<?>> verifiedClasses)", "testcase": false, "constructor": false}, {"identifier": "createProperty", "parameters": "(final String baseURI, final Class<?> resourceClass, final Method method, final OslcPropertyDefinition propertyDefinitionAnnotation, final Set<Class<?>> verifiedClasses)", "modifiers": "@SuppressWarnings(\"rawtypes\") // supress warning when casting Arrays.asList() to a Collection private static", "return": "Property", "signature": "Property createProperty(final String baseURI, final Class<?> resourceClass, final Method method, final OslcPropertyDefinition propertyDefinitionAnnotation, final Set<Class<?>> verifiedClasses)", "full_signature": "@SuppressWarnings(\"rawtypes\") // supress warning when casting Arrays.asList() to a Collection private static Property createProperty(final String baseURI, final Class<?> resourceClass, final Method method, final OslcPropertyDefinition propertyDefinitionAnnotation, final Set<Class<?>> verifiedClasses)", "class_method_signature": "ResourceShapeFactory.createProperty(final String baseURI, final Class<?> resourceClass, final Method method, final OslcPropertyDefinition propertyDefinitionAnnotation, final Set<Class<?>> verifiedClasses)", "testcase": false, "constructor": false}, {"identifier": "getDefaultPropertyName", "parameters": "(final Method method)", "modifiers": "protected static", "return": "String", "signature": "String getDefaultPropertyName(final Method method)", "full_signature": "protected static String getDefaultPropertyName(final Method method)", "class_method_signature": "ResourceShapeFactory.getDefaultPropertyName(final Method method)", "testcase": false, "constructor": false}, {"identifier": "getDefaultValueType", "parameters": "(final Class<?> resourceClass, final Method method, final Class<?> componentType)", "modifiers": "private static", "return": "ValueType", "signature": "ValueType getDefaultValueType(final Class<?> resourceClass, final Method method, final Class<?> componentType)", "full_signature": "private static ValueType getDefaultValueType(final Class<?> resourceClass, final Method method, final Class<?> componentType)", "class_method_signature": "ResourceShapeFactory.getDefaultValueType(final Class<?> resourceClass, final Method method, final Class<?> componentType)", "testcase": false, "constructor": false}, {"identifier": "getDefaultRepresentation", "parameters": "(final Class<?> componentType)", "modifiers": "private static", "return": "Representation", "signature": "Representation getDefaultRepresentation(final Class<?> componentType)", "full_signature": "private static Representation getDefaultRepresentation(final Class<?> componentType)", "class_method_signature": "ResourceShapeFactory.getDefaultRepresentation(final Class<?> componentType)", "testcase": false, "constructor": false}, {"identifier": "getDefaultOccurs", "parameters": "(final Class<?> type)", "modifiers": "private static", "return": "Occurs", "signature": "Occurs getDefaultOccurs(final Class<?> type)", "full_signature": "private static Occurs getDefaultOccurs(final Class<?> type)", "class_method_signature": "ResourceShapeFactory.getDefaultOccurs(final Class<?> type)", "testcase": false, "constructor": false}, {"identifier": "getComponentType", "parameters": "(final Class<?> resourceClass, final Method method, final Class<?> type)", "modifiers": "protected static", "return": "Class<?>", "signature": "Class<?> getComponentType(final Class<?> resourceClass, final Method method, final Class<?> type)", "full_signature": "protected static Class<?> getComponentType(final Class<?> resourceClass, final Method method, final Class<?> type)", "class_method_signature": "ResourceShapeFactory.getComponentType(final Class<?> resourceClass, final Method method, final Class<?> type)", "testcase": false, "constructor": false}, {"identifier": "validateSetMethodExists", "parameters": "(final Class<?> resourceClass, final Method getMethod)", "modifiers": "protected static", "return": "void", "signature": "void validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "full_signature": "protected static void validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "class_method_signature": "ResourceShapeFactory.validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "testcase": false, "constructor": false}, {"identifier": "isCollectionType", "parameters": "(final Class<?> returnType)", "modifiers": "static", "return": "boolean", "signature": "boolean isCollectionType(final Class<?> returnType)", "full_signature": "static boolean isCollectionType(final Class<?> returnType)", "class_method_signature": "ResourceShapeFactory.isCollectionType(final Class<?> returnType)", "testcase": false, "constructor": false}, {"identifier": "validateUserSpecifiedOccurs", "parameters": "(final Class<?> resourceClass, final Method method, final OslcOccurs occursAnnotation)", "modifiers": "private static", "return": "void", "signature": "void validateUserSpecifiedOccurs(final Class<?> resourceClass, final Method method, final OslcOccurs occursAnnotation)", "full_signature": "private static void validateUserSpecifiedOccurs(final Class<?> resourceClass, final Method method, final OslcOccurs occursAnnotation)", "class_method_signature": "ResourceShapeFactory.validateUserSpecifiedOccurs(final Class<?> resourceClass, final Method method, final OslcOccurs occursAnnotation)", "testcase": false, "constructor": false}, {"identifier": "validateUserSpecifiedValueType", "parameters": "(final Class<?> resourceClass, final Method method, final ValueType userSpecifiedValueType, final Class<?> componentType)", "modifiers": "protected static", "return": "void", "signature": "void validateUserSpecifiedValueType(final Class<?> resourceClass, final Method method, final ValueType userSpecifiedValueType, final Class<?> componentType)", "full_signature": "protected static void validateUserSpecifiedValueType(final Class<?> resourceClass, final Method method, final ValueType userSpecifiedValueType, final Class<?> componentType)", "class_method_signature": "ResourceShapeFactory.validateUserSpecifiedValueType(final Class<?> resourceClass, final Method method, final ValueType userSpecifiedValueType, final Class<?> componentType)", "testcase": false, "constructor": false}, {"identifier": "validateUserSpecifiedRepresentation", "parameters": "(final Class<?> resourceClass, final Method method, final Representation userSpecifiedRepresentation, final Class<?> componentType)", "modifiers": "private static", "return": "void", "signature": "void validateUserSpecifiedRepresentation(final Class<?> resourceClass, final Method method, final Representation userSpecifiedRepresentation, final Class<?> componentType)", "full_signature": "private static void validateUserSpecifiedRepresentation(final Class<?> resourceClass, final Method method, final Representation userSpecifiedRepresentation, final Class<?> componentType)", "class_method_signature": "ResourceShapeFactory.validateUserSpecifiedRepresentation(final Class<?> resourceClass, final Method method, final Representation userSpecifiedRepresentation, final Class<?> componentType)", "testcase": false, "constructor": false}], "file": "oslc4j-core/src/main/java/org/eclipse/lyo/oslc4j/core/model/ResourceShapeFactory.java"}, "focal_method": {"identifier": "validateSetMethodExists", "parameters": "(final Class<?> resourceClass, final Method getMethod)", "modifiers": "protected static", "return": "void", "body": "protected static void validateSetMethodExists(final Class<?> resourceClass, final Method getMethod) throws OslcCoreMissingSetMethodException {\n\t\tfinal String getMethodName = getMethod.getName();\n\n\t\tfinal String setMethodName;\n\t\tif (getMethodName.startsWith(METHOD_NAME_START_GET)) {\n\t\t\tsetMethodName = METHOD_NAME_START_SET + getMethodName.substring(METHOD_NAME_START_GET_LENGTH);\n\t\t} else {\n\t\t\tsetMethodName = METHOD_NAME_START_SET + getMethodName.substring(METHOD_NAME_START_IS_LENGTH);\n\t\t}\n\n        final Class<?> returnType = getMethod.getReturnType();\n        if(!isCollectionType(returnType)) {\n            try {\n                resourceClass.getMethod(setMethodName, returnType);\n            } catch (final NoSuchMethodException exception) {\n                throw new OslcCoreMissingSetMethodException(resourceClass, getMethod, exception);\n            }\n        } else {\n            final List<Method> methods = Arrays.stream(resourceClass.getMethods())\n                                               .filter(m -> m.getName().equals(setMethodName))\n                                               .collect(Collectors.toList());\n            if (methods.size() == 0) {\n                throw new OslcCoreMissingSetMethodException(resourceClass, getMethod, null);\n            }\n\n            if (methods.size() > 1) {\n                throw new IllegalArgumentException(\n                        \"Multiple setters on the same RDF property are not yet supported\");\n            }\n\n            final Method method = methods.get(0);\n\n            final Type[] parameterTypes = method.getGenericParameterTypes();\n            if (parameterTypes == null || parameterTypes.length == 0 || parameterTypes.length > 1) {\n                throw new IllegalArgumentException(\n                        String.format(\"Method '%s' shall have exactly one argument\",\n                                      method.getName()\n                        ));\n            }\n\n            final ParameterizedType setterArgumentType = (ParameterizedType) parameterTypes[0];\n            final ParameterizedType genericReturnType = (ParameterizedType) getMethod.getGenericReturnType();\n            if (!genericReturnType.getActualTypeArguments()[0].equals(setterArgumentType.getActualTypeArguments()[0])) {\n                // if a getter returns HashSet<T>, we want the same t in the setter Set<T>\n                throw new OslcCoreMissingSetMethodException(resourceClass, getMethod, null);\n            }\n        }\n\t}", "signature": "void validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "full_signature": "protected static void validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "class_method_signature": "ResourceShapeFactory.validateSetMethodExists(final Class<?> resourceClass, final Method getMethod)", "testcase": false, "constructor": false, "invocations": ["getName", "startsWith", "substring", "substring", "getReturnType", "isCollectionType", "getMethod", "collect", "filter", "stream", "getMethods", "equals", "getName", "toList", "size", "size", "get", "getGenericParameterTypes", "format", "getName", "getGenericReturnType", "equals", "getActualTypeArguments", "getActualTypeArguments"]}, "repository": {"repo_id": 2666662, "url": "https://github.com/eclipse/lyo.core", "language": "Java", "is_fork": false, "fork_count": 12, "stargazer_count": 11, "size": 3141, "license": "licensed"}}