{"test_class": {"identifier": "AdditionalDocumentsControllerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@ClassRule\n    public static TemporaryFolder tf = new TemporaryFolder();", "modifier": "@ClassRule\n    public static", "type": "TemporaryFolder", "declarator": "tf = new TemporaryFolder()", "var_name": "tf"}, {"original_string": "private static final String CONTROLLER_NAME = \"additionalDocuments\";", "modifier": "private static final", "type": "String", "declarator": "CONTROLLER_NAME = \"additionalDocuments\"", "var_name": "CONTROLLER_NAME"}, {"original_string": "private static final String DATA_NAME = \"additional_documents\";", "modifier": "private static final", "type": "String", "declarator": "DATA_NAME = \"additional_documents\"", "var_name": "DATA_NAME"}, {"original_string": "private static final String FILE_FIELD_NAME = \"file\";", "modifier": "private static final", "type": "String", "declarator": "FILE_FIELD_NAME = \"file\"", "var_name": "FILE_FIELD_NAME"}, {"original_string": "private static final String COMMENTS_FIELD_NAME = \"comments\";", "modifier": "private static final", "type": "String", "declarator": "COMMENTS_FIELD_NAME = \"comments\"", "var_name": "COMMENTS_FIELD_NAME"}, {"original_string": "@Rule\n    public MockitoComponentMockingRule<PatientDataController<Attachment>> mocker =\n        new MockitoComponentMockingRule<>(AdditionalDocumentsController.class);", "modifier": "@Rule\n    public", "type": "MockitoComponentMockingRule<PatientDataController<Attachment>>", "declarator": "mocker =\n        new MockitoComponentMockingRule<>(AdditionalDocumentsController.class)", "var_name": "mocker"}, {"original_string": "@Mock\n    private XWikiContext context;", "modifier": "@Mock\n    private", "type": "XWikiContext", "declarator": "context", "var_name": "context"}, {"original_string": "@Mock\n    private XWiki xwiki;", "modifier": "@Mock\n    private", "type": "XWiki", "declarator": "xwiki", "var_name": "xwiki"}, {"original_string": "@Mock\n    private Patient patient;", "modifier": "@Mock\n    private", "type": "Patient", "declarator": "patient", "var_name": "patient"}, {"original_string": "@Mock\n    private XWikiDocument doc;", "modifier": "@Mock\n    private", "type": "XWikiDocument", "declarator": "doc", "var_name": "doc"}, {"original_string": "@Mock\n    private BaseObject file1;", "modifier": "@Mock\n    private", "type": "BaseObject", "declarator": "file1", "var_name": "file1"}, {"original_string": "@Mock\n    private BaseObject file2;", "modifier": "@Mock\n    private", "type": "BaseObject", "declarator": "file2", "var_name": "file2"}, {"original_string": "@Mock\n    private XWikiAttachment xattachment1;", "modifier": "@Mock\n    private", "type": "XWikiAttachment", "declarator": "xattachment1", "var_name": "xattachment1"}, {"original_string": "@Mock\n    private XWikiAttachment xattachment2;", "modifier": "@Mock\n    private", "type": "XWikiAttachment", "declarator": "xattachment2", "var_name": "xattachment2"}, {"original_string": "@Mock\n    private Attachment attachment1;", "modifier": "@Mock\n    private", "type": "Attachment", "declarator": "attachment1", "var_name": "attachment1"}, {"original_string": "@Mock\n    private Attachment attachment2;", "modifier": "@Mock\n    private", "type": "Attachment", "declarator": "attachment2", "var_name": "attachment2"}, {"original_string": "private Date date1;", "modifier": "private", "type": "Date", "declarator": "date1", "var_name": "date1"}, {"original_string": "private Date date2;", "modifier": "private", "type": "Date", "declarator": "date2", "var_name": "date2"}, {"original_string": "private DocumentReference author1 = new DocumentReference(\"main\", \"Users\", \"padams\");", "modifier": "private", "type": "DocumentReference", "declarator": "author1 = new DocumentReference(\"main\", \"Users\", \"padams\")", "var_name": "author1"}, {"original_string": "private DocumentReference author2 = new DocumentReference(\"genetics\", \"Users\", \"hmccoy\");", "modifier": "private", "type": "DocumentReference", "declarator": "author2 = new DocumentReference(\"genetics\", \"Users\", \"hmccoy\")", "var_name": "author2"}, {"original_string": "private AttachmentAdapterFactory adapter;", "modifier": "private", "type": "AttachmentAdapterFactory", "declarator": "adapter", "var_name": "adapter"}, {"original_string": "private JSONObject json1shallow = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a1.pdf\\\",\"\n        + \"\\\"filesize\\\":4,\"\n        + \"\\\"author\\\":\\\"Users.padams\\\",\"\n        + \"\\\"date\\\":\\\"2017-01-01T12:00:00.000Z\\\",\"\n        + \"\\\"link\\\":\\\"/download/data/abc.def\\\",\"\n        + \"\\\"comments\\\":\\\"Comment 1\\\"\"\n        + \"}\");", "modifier": "private", "type": "JSONObject", "declarator": "json1shallow = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a1.pdf\\\",\"\n        + \"\\\"filesize\\\":4,\"\n        + \"\\\"author\\\":\\\"Users.padams\\\",\"\n        + \"\\\"date\\\":\\\"2017-01-01T12:00:00.000Z\\\",\"\n        + \"\\\"link\\\":\\\"/download/data/abc.def\\\",\"\n        + \"\\\"comments\\\":\\\"Comment 1\\\"\"\n        + \"}\")", "var_name": "json1shallow"}, {"original_string": "private JSONObject json1full = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a1.pdf\\\",\"\n        + \"\\\"filesize\\\":4,\"\n        + \"\\\"author\\\":\\\"Users.padams\\\",\"\n        + \"\\\"date\\\":\\\"2017-01-01T12:00:00.000Z\\\",\"\n        + \"\\\"content\\\":\\\"YWJjZA==\\\",\"\n        + \"\\\"comments\\\":\\\"Comment 1\\\"\"\n        + \"}\");", "modifier": "private", "type": "JSONObject", "declarator": "json1full = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a1.pdf\\\",\"\n        + \"\\\"filesize\\\":4,\"\n        + \"\\\"author\\\":\\\"Users.padams\\\",\"\n        + \"\\\"date\\\":\\\"2017-01-01T12:00:00.000Z\\\",\"\n        + \"\\\"content\\\":\\\"YWJjZA==\\\",\"\n        + \"\\\"comments\\\":\\\"Comment 1\\\"\"\n        + \"}\")", "var_name": "json1full"}, {"original_string": "private JSONObject json2shallow = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a2.pdf\\\",\"\n        + \"\\\"filesize\\\":3,\"\n        + \"\\\"author\\\":\\\"genetics:Users.hmccoy\\\",\"\n        + \"\\\"date\\\":\\\"2016-08-01T14:00:00.000Z\\\",\"\n        + \"\\\"link\\\":\\\"/download/data/xyz.123\\\",\"\n        + \"}\");", "modifier": "private", "type": "JSONObject", "declarator": "json2shallow = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a2.pdf\\\",\"\n        + \"\\\"filesize\\\":3,\"\n        + \"\\\"author\\\":\\\"genetics:Users.hmccoy\\\",\"\n        + \"\\\"date\\\":\\\"2016-08-01T14:00:00.000Z\\\",\"\n        + \"\\\"link\\\":\\\"/download/data/xyz.123\\\",\"\n        + \"}\")", "var_name": "json2shallow"}, {"original_string": "private JSONObject json2full = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a2.pdf\\\",\"\n        + \"\\\"filesize\\\":3,\"\n        + \"\\\"author\\\":\\\"genetics:Users.hmccoy\\\",\"\n        + \"\\\"date\\\":\\\"2016-08-01T14:00:00.000Z\\\",\"\n        + \"\\\"content\\\":\\\"eHl6\\\"\"\n        + \"}\");", "modifier": "private", "type": "JSONObject", "declarator": "json2full = new JSONObject(\"{\"\n        + \"\\\"filename\\\":\\\"a2.pdf\\\",\"\n        + \"\\\"filesize\\\":3,\"\n        + \"\\\"author\\\":\\\"genetics:Users.hmccoy\\\",\"\n        + \"\\\"date\\\":\\\"2016-08-01T14:00:00.000Z\\\",\"\n        + \"\\\"content\\\":\\\"eHl6\\\"\"\n        + \"}\")", "var_name": "json2full"}], "file": "components/patient-data/impl/src/test/java/org/phenotips/data/internal/controller/AdditionalDocumentsControllerTest.java"}, "test_case": {"identifier": "saveClearsRecordsFieldWhenEmptyDataPresentNoDataSavedAndPolicyIsMerge", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void saveClearsRecordsFieldWhenEmptyDataPresentNoDataSavedAndPolicyIsMerge()\n        throws ComponentLookupException, XWikiException\n    {\n        when(this.patient.getData(CONTROLLER_NAME))\n            .thenReturn(new IndexedPatientData<>(CONTROLLER_NAME, Collections.emptyList()));\n        when(this.doc.getXObjects(AdditionalDocumentsController.CLASS_REFERENCE))\n            .thenReturn(Collections.emptyList());\n        this.mocker.getComponentUnderTest().save(this.patient, PatientWritePolicy.MERGE);\n        verify(this.doc).removeXObjects(AdditionalDocumentsController.CLASS_REFERENCE);\n        verify(this.doc, never()).newXObject(any(EntityReference.class), any(XWikiContext.class));\n        verify(this.doc, never()).getAttachment(anyString());\n        verify(this.doc, never()).addAttachment(any(XWikiAttachment.class));\n    }", "signature": "void saveClearsRecordsFieldWhenEmptyDataPresentNoDataSavedAndPolicyIsMerge()", "full_signature": "@Test public void saveClearsRecordsFieldWhenEmptyDataPresentNoDataSavedAndPolicyIsMerge()", "class_method_signature": "AdditionalDocumentsControllerTest.saveClearsRecordsFieldWhenEmptyDataPresentNoDataSavedAndPolicyIsMerge()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "getData", "emptyList", "thenReturn", "when", "getXObjects", "emptyList", "save", "getComponentUnderTest", "removeXObjects", "verify", "newXObject", "verify", "never", "any", "any", "getAttachment", "verify", "never", "anyString", "addAttachment", "verify", "never", "any"]}, "focal_class": {"identifier": "AdditionalDocumentsController", "superclass": "", "interfaces": "implements PatientDataController<Attachment>", "fields": [{"original_string": "public static final EntityReference CLASS_REFERENCE = new EntityReference(\"ExternalFileClass\", EntityType.DOCUMENT,\n        Constants.CODE_SPACE_REFERENCE);", "modifier": "public static final", "type": "EntityReference", "declarator": "CLASS_REFERENCE = new EntityReference(\"ExternalFileClass\", EntityType.DOCUMENT,\n        Constants.CODE_SPACE_REFERENCE)", "var_name": "CLASS_REFERENCE"}, {"original_string": "private static final String DATA_NAME = \"additional_documents\";", "modifier": "private static final", "type": "String", "declarator": "DATA_NAME = \"additional_documents\"", "var_name": "DATA_NAME"}, {"original_string": "private static final String FILE_FIELD_NAME = \"file\";", "modifier": "private static final", "type": "String", "declarator": "FILE_FIELD_NAME = \"file\"", "var_name": "FILE_FIELD_NAME"}, {"original_string": "private static final String COMMENTS_FIELD_NAME = \"comments\";", "modifier": "private static final", "type": "String", "declarator": "COMMENTS_FIELD_NAME = \"comments\"", "var_name": "COMMENTS_FIELD_NAME"}, {"original_string": "@Inject\n    private Provider<XWikiContext> contextProvider;", "modifier": "@Inject\n    private", "type": "Provider<XWikiContext>", "declarator": "contextProvider", "var_name": "contextProvider"}, {"original_string": "@Inject\n    private AttachmentAdapterFactory adapter;", "modifier": "@Inject\n    private", "type": "AttachmentAdapterFactory", "declarator": "adapter", "var_name": "adapter"}, {"original_string": "@Inject\n    private Logger logger;", "modifier": "@Inject\n    private", "type": "Logger", "declarator": "logger", "var_name": "logger"}], "methods": [{"identifier": "load", "parameters": "(Patient patient)", "modifiers": "@Override public", "return": "PatientData<Attachment>", "signature": "PatientData<Attachment> load(Patient patient)", "full_signature": "@Override public PatientData<Attachment> load(Patient patient)", "class_method_signature": "AdditionalDocumentsController.load(Patient patient)", "testcase": false, "constructor": false}, {"identifier": "save", "parameters": "(@Nonnull final Patient patient)", "modifiers": "@Override public", "return": "void", "signature": "void save(@Nonnull final Patient patient)", "full_signature": "@Override public void save(@Nonnull final Patient patient)", "class_method_signature": "AdditionalDocumentsController.save(@Nonnull final Patient patient)", "testcase": false, "constructor": false}, {"identifier": "save", "parameters": "(@Nonnull final Patient patient, @Nonnull final PatientWritePolicy policy)", "modifiers": "@Override public", "return": "void", "signature": "void save(@Nonnull final Patient patient, @Nonnull final PatientWritePolicy policy)", "full_signature": "@Override public void save(@Nonnull final Patient patient, @Nonnull final PatientWritePolicy policy)", "class_method_signature": "AdditionalDocumentsController.save(@Nonnull final Patient patient, @Nonnull final PatientWritePolicy policy)", "testcase": false, "constructor": false}, {"identifier": "saveAttachments", "parameters": "(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Patient patient,\n        @Nonnull final PatientData<Attachment> files,\n        @Nonnull final PatientWritePolicy policy,\n        @Nonnull final XWikiContext context)", "modifiers": "private", "return": "void", "signature": "void saveAttachments(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Patient patient,\n        @Nonnull final PatientData<Attachment> files,\n        @Nonnull final PatientWritePolicy policy,\n        @Nonnull final XWikiContext context)", "full_signature": "private void saveAttachments(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Patient patient,\n        @Nonnull final PatientData<Attachment> files,\n        @Nonnull final PatientWritePolicy policy,\n        @Nonnull final XWikiContext context)", "class_method_signature": "AdditionalDocumentsController.saveAttachments(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Patient patient,\n        @Nonnull final PatientData<Attachment> files,\n        @Nonnull final PatientWritePolicy policy,\n        @Nonnull final XWikiContext context)", "testcase": false, "constructor": false}, {"identifier": "saveAttachment", "parameters": "(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Attachment file,\n        @Nonnull final XWikiContext context)", "modifiers": "private", "return": "void", "signature": "void saveAttachment(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Attachment file,\n        @Nonnull final XWikiContext context)", "full_signature": "private void saveAttachment(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Attachment file,\n        @Nonnull final XWikiContext context)", "class_method_signature": "AdditionalDocumentsController.saveAttachment(\n        @Nonnull final XWikiDocument doc,\n        @Nonnull final Attachment file,\n        @Nonnull final XWikiContext context)", "testcase": false, "constructor": false}, {"identifier": "writeJSON", "parameters": "(Patient patient, JSONObject json)", "modifiers": "@Override public", "return": "void", "signature": "void writeJSON(Patient patient, JSONObject json)", "full_signature": "@Override public void writeJSON(Patient patient, JSONObject json)", "class_method_signature": "AdditionalDocumentsController.writeJSON(Patient patient, JSONObject json)", "testcase": false, "constructor": false}, {"identifier": "writeJSON", "parameters": "(Patient patient, JSONObject json, Collection<String> selectedFieldNames)", "modifiers": "@Override public", "return": "void", "signature": "void writeJSON(Patient patient, JSONObject json, Collection<String> selectedFieldNames)", "full_signature": "@Override public void writeJSON(Patient patient, JSONObject json, Collection<String> selectedFieldNames)", "class_method_signature": "AdditionalDocumentsController.writeJSON(Patient patient, JSONObject json, Collection<String> selectedFieldNames)", "testcase": false, "constructor": false}, {"identifier": "readJSON", "parameters": "(JSONObject json)", "modifiers": "@Override public", "return": "PatientData<Attachment>", "signature": "PatientData<Attachment> readJSON(JSONObject json)", "full_signature": "@Override public PatientData<Attachment> readJSON(JSONObject json)", "class_method_signature": "AdditionalDocumentsController.readJSON(JSONObject json)", "testcase": false, "constructor": false}, {"identifier": "getName", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String getName()", "full_signature": "@Override public String getName()", "class_method_signature": "AdditionalDocumentsController.getName()", "testcase": false, "constructor": false}], "file": "components/patient-data/impl/src/main/java/org/phenotips/data/internal/controller/AdditionalDocumentsController.java"}, "focal_method": {"identifier": "save", "parameters": "(@Nonnull final Patient patient)", "modifiers": "@Override public", "return": "void", "body": "@Override\n    public void save(@Nonnull final Patient patient)\n    {\n        save(patient, PatientWritePolicy.UPDATE);\n    }", "signature": "void save(@Nonnull final Patient patient)", "full_signature": "@Override public void save(@Nonnull final Patient patient)", "class_method_signature": "AdditionalDocumentsController.save(@Nonnull final Patient patient)", "testcase": false, "constructor": false, "invocations": ["save"]}, "repository": {"repo_id": 2685841, "url": "https://github.com/phenotips/phenotips", "language": "Java", "is_fork": false, "fork_count": 64, "stargazer_count": 87, "size": 1662205, "license": "licensed"}}