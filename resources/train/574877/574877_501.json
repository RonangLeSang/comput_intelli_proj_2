{"test_class": {"identifier": "EndpointDiscoveryIdentifiersRefreshCacheTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final URI TEST_URI = URI.create(\"https://localhost\");", "modifier": "private static final", "type": "URI", "declarator": "TEST_URI = URI.create(\"https://localhost\")", "var_name": "TEST_URI"}], "file": "aws-java-sdk-core/src/test/java/com/amazonaws/endpointdiscovery/EndpointDiscoveryIdentifiersRefreshCacheTest.java"}, "test_case": {"identifier": "loadAndScheduleEvict", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void loadAndScheduleEvict() throws Exception {\n        EndpointDiscoveryCacheLoader<String, URI> cacheLoader = new EndpointDiscoveryCacheLoader<String, URI>() {\n            @Override\n            public URI load(String key, AmazonWebServiceRequest discoveryRequest) {\n                return TEST_URI;\n            }\n        };\n\n        EndpointDiscoveryIdentifiersRefreshCache<String> endpointDiscoveryIdentifiersRefreshCache =\n            new EndpointDiscoveryIdentifiersRefreshCache<String>(cacheLoader) {\n\n\n                @Override\n                public URI get(String key, AmazonWebServiceRequest discoveryRequest, boolean required, URI defaultEndpoint) {\n                    return null;\n                }\n\n                @Override\n                public URI put(String key, AmazonWebServiceRequest discoveryRequest, Map<String, String> endpointDetails, URI defaultEndpoint) {\n                    return null;\n                }\n\n                @Override\n                public String constructKey(String key, AmazonWebServiceRequest discoveryRequest) {\n                    return null;\n                }\n            };\n\n        endpointDiscoveryIdentifiersRefreshCache.cache.put(\"test-key\", TEST_URI);\n        endpointDiscoveryIdentifiersRefreshCache.loadAndScheduleEvict(\"test-key\", 10, TimeUnit.MILLISECONDS);\n\n        assertThat(endpointDiscoveryIdentifiersRefreshCache.cache, hasEntry(\"test-key\", TEST_URI));\n        Thread.sleep(100);\n        assertThat(endpointDiscoveryIdentifiersRefreshCache.cache, not(hasKey(\"test-key\")));\n    }", "signature": "void loadAndScheduleEvict()", "full_signature": "@Test public void loadAndScheduleEvict()", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCacheTest.loadAndScheduleEvict()", "testcase": true, "constructor": false, "invocations": ["put", "loadAndScheduleEvict", "assertThat", "hasEntry", "sleep", "assertThat", "not", "hasKey"]}, "focal_class": {"identifier": "EndpointDiscoveryIdentifiersRefreshCache", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Log log = LogFactory.getLog(EndpointDiscoveryIdentifiersRefreshCache.class);", "modifier": "private static final", "type": "Log", "declarator": "log = LogFactory.getLog(EndpointDiscoveryIdentifiersRefreshCache.class)", "var_name": "log"}, {"original_string": "private final ScheduledExecutorService executorService = Executors.newSingleThreadScheduledExecutor(DaemonThreadFactory.INSTANCE);", "modifier": "private final", "type": "ScheduledExecutorService", "declarator": "executorService = Executors.newSingleThreadScheduledExecutor(DaemonThreadFactory.INSTANCE)", "var_name": "executorService"}, {"original_string": "private final EndpointDiscoveryCacheLoader<String, Map<String, String>> cacheLoader;", "modifier": "private final", "type": "EndpointDiscoveryCacheLoader<String, Map<String, String>>", "declarator": "cacheLoader", "var_name": "cacheLoader"}, {"original_string": "protected final Map<String, URI> cache = new ConcurrentHashMap<String, URI>();", "modifier": "protected final", "type": "Map<String, URI>", "declarator": "cache = new ConcurrentHashMap<String, URI>()", "var_name": "cache"}], "methods": [{"identifier": "EndpointDiscoveryIdentifiersRefreshCache", "parameters": "(EndpointDiscoveryCacheLoader cacheLoader)", "modifiers": "public", "return": "", "signature": " EndpointDiscoveryIdentifiersRefreshCache(EndpointDiscoveryCacheLoader cacheLoader)", "full_signature": "public  EndpointDiscoveryIdentifiersRefreshCache(EndpointDiscoveryCacheLoader cacheLoader)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.EndpointDiscoveryIdentifiersRefreshCache(EndpointDiscoveryCacheLoader cacheLoader)", "testcase": false, "constructor": true}, {"identifier": "get", "parameters": "(K key, AmazonWebServiceRequest discoveryRequest, boolean required, URI defaultEndpoint)", "modifiers": "public abstract", "return": "URI", "signature": "URI get(K key, AmazonWebServiceRequest discoveryRequest, boolean required, URI defaultEndpoint)", "full_signature": "public abstract URI get(K key, AmazonWebServiceRequest discoveryRequest, boolean required, URI defaultEndpoint)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.get(K key, AmazonWebServiceRequest discoveryRequest, boolean required, URI defaultEndpoint)", "testcase": false, "constructor": false}, {"identifier": "put", "parameters": "(String key, AmazonWebServiceRequest discoveryRequest, Map<String, String> endpointDetails, URI defaultEndpoint)", "modifiers": "public abstract", "return": "URI", "signature": "URI put(String key, AmazonWebServiceRequest discoveryRequest, Map<String, String> endpointDetails, URI defaultEndpoint)", "full_signature": "public abstract URI put(String key, AmazonWebServiceRequest discoveryRequest, Map<String, String> endpointDetails, URI defaultEndpoint)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.put(String key, AmazonWebServiceRequest discoveryRequest, Map<String, String> endpointDetails, URI defaultEndpoint)", "testcase": false, "constructor": false}, {"identifier": "constructKey", "parameters": "(String key, AmazonWebServiceRequest discoveryRequest)", "modifiers": "public abstract", "return": "String", "signature": "String constructKey(String key, AmazonWebServiceRequest discoveryRequest)", "full_signature": "public abstract String constructKey(String key, AmazonWebServiceRequest discoveryRequest)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.constructKey(String key, AmazonWebServiceRequest discoveryRequest)", "testcase": false, "constructor": false}, {"identifier": "evict", "parameters": "(String key)", "modifiers": "public", "return": "void", "signature": "void evict(String key)", "full_signature": "public void evict(String key)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.evict(String key)", "testcase": false, "constructor": false}, {"identifier": "discoverEndpoint", "parameters": "(String key, AmazonWebServiceRequest request, boolean required, URI defaultEndpoint)", "modifiers": "public", "return": "URI", "signature": "URI discoverEndpoint(String key, AmazonWebServiceRequest request, boolean required, URI defaultEndpoint)", "full_signature": "public URI discoverEndpoint(String key, AmazonWebServiceRequest request, boolean required, URI defaultEndpoint)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.discoverEndpoint(String key, AmazonWebServiceRequest request, boolean required, URI defaultEndpoint)", "testcase": false, "constructor": false}, {"identifier": "loadAndScheduleRefresh", "parameters": "(final String key,\n                                                       final AmazonWebServiceRequest request,\n                                                       final long refreshPeriod,\n                                                       final URI defaultEndpoint)", "modifiers": "public", "return": "ScheduledFuture<URI>", "signature": "ScheduledFuture<URI> loadAndScheduleRefresh(final String key,\n                                                       final AmazonWebServiceRequest request,\n                                                       final long refreshPeriod,\n                                                       final URI defaultEndpoint)", "full_signature": "public ScheduledFuture<URI> loadAndScheduleRefresh(final String key,\n                                                       final AmazonWebServiceRequest request,\n                                                       final long refreshPeriod,\n                                                       final URI defaultEndpoint)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.loadAndScheduleRefresh(final String key,\n                                                       final AmazonWebServiceRequest request,\n                                                       final long refreshPeriod,\n                                                       final URI defaultEndpoint)", "testcase": false, "constructor": false}, {"identifier": "loadAndScheduleEvict", "parameters": "(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "modifiers": "public", "return": "ScheduledFuture<?>", "signature": "ScheduledFuture<?> loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "full_signature": "public ScheduledFuture<?> loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "testcase": false, "constructor": false}, {"identifier": "shutdown", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void shutdown()", "full_signature": "public void shutdown()", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.shutdown()", "testcase": false, "constructor": false}], "file": "aws-java-sdk-core/src/main/java/com/amazonaws/endpointdiscovery/EndpointDiscoveryIdentifiersRefreshCache.java"}, "focal_method": {"identifier": "loadAndScheduleEvict", "parameters": "(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "modifiers": "public", "return": "ScheduledFuture<?>", "body": "public ScheduledFuture<?> loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit) {\n        return executorService.schedule(new Runnable() {\n            @Override\n            public void run() {\n                evict(key);\n            }\n        }, refreshPeriod, refreshPeriodTimeUnit);\n    }", "signature": "ScheduledFuture<?> loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "full_signature": "public ScheduledFuture<?> loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "class_method_signature": "EndpointDiscoveryIdentifiersRefreshCache.loadAndScheduleEvict(final String key,\n                                                   final long refreshPeriod,\n                                                   final TimeUnit refreshPeriodTimeUnit)", "testcase": false, "constructor": false, "invocations": ["schedule", "evict"]}, "repository": {"repo_id": 574877, "url": "https://github.com/aws/aws-sdk-java", "stars": 3141, "created": "3/22/2010 11:34:58 PM +00:00", "updates": "2020-01-25T22:06:42+00:00", "fork": "False", "license": "licensed"}}