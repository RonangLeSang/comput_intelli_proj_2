{"test_class": {"identifier": "AttachmentListMetadataSerializerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TEST_CONTENT =\n        \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\"\n      + \"<attachment-list serializer=\\\"attachment-list-meta/1.0\\\">\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>10</filesize>\\n\"\n      + \"  <author>me</author>\\n\"\n      + \"  <version>1.1</version>\\n\"\n      + \"  <comment>something whitty</comment>\\n\"\n      + \"  <date>1293045632168</date>\\n\"\n      + \" </attachment>\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>5</filesize>\\n\"\n      + \"  <author>you</author>\\n\"\n      + \"  <version>1.2</version>\\n\"\n      + \"  <comment>a comment</comment>\\n\"\n      + \"  <date>1293789456868</date>\\n\"\n      + \" </attachment>\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>20</filesize>\\n\"\n      + \"  <author>them</author>\\n\"\n      + \"  <version>1.3</version>\\n\"\n      + \"  <comment>i saved it</comment>\\n\"\n      + \"  <date>1293012345668</date>\\n\"\n      + \" </attachment>\\n\"\n      + \"</attachment-list>\";", "modifier": "private static final", "type": "String", "declarator": "TEST_CONTENT =\n        \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\"\n      + \"<attachment-list serializer=\\\"attachment-list-meta/1.0\\\">\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>10</filesize>\\n\"\n      + \"  <author>me</author>\\n\"\n      + \"  <version>1.1</version>\\n\"\n      + \"  <comment>something whitty</comment>\\n\"\n      + \"  <date>1293045632168</date>\\n\"\n      + \" </attachment>\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>5</filesize>\\n\"\n      + \"  <author>you</author>\\n\"\n      + \"  <version>1.2</version>\\n\"\n      + \"  <comment>a comment</comment>\\n\"\n      + \"  <date>1293789456868</date>\\n\"\n      + \" </attachment>\\n\"\n      + \" <attachment serializer=\\\"attachment-meta/1.0\\\">\\n\"\n      + \"  <filename>file1</filename>\\n\"\n      + \"  <filesize>20</filesize>\\n\"\n      + \"  <author>them</author>\\n\"\n      + \"  <version>1.3</version>\\n\"\n      + \"  <comment>i saved it</comment>\\n\"\n      + \"  <date>1293012345668</date>\\n\"\n      + \" </attachment>\\n\"\n      + \"</attachment-list>\"", "var_name": "TEST_CONTENT"}, {"original_string": "private AttachmentListMetadataSerializer serializer;", "modifier": "private", "type": "AttachmentListMetadataSerializer", "declarator": "serializer", "var_name": "serializer"}], "file": "xwiki-platform-core/xwiki-platform-store/xwiki-platform-store-filesystem-oldcore/src/test/java/org/xwiki/store/serialization/xml/internal/AttachmentListMetadataSerializerTest.java"}, "test_case": {"identifier": "testParse", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testParse() throws Exception\n    {\n        final ByteArrayInputStream bais = new ByteArrayInputStream(TEST_CONTENT.getBytes(\"US-ASCII\"));\n        final List<XWikiAttachment> attachList = this.serializer.parse(bais);\n        bais.close();\n        Assert.assertTrue(\"Attachment list was wrong size\", 3 == attachList.size());\n\n        Assert.assertEquals(\"Attachment1 had wrong name\", \"file1\", attachList.get(0).getFilename());\n        Assert.assertEquals(\"Attachment2 had wrong name\", \"file1\", attachList.get(1).getFilename());\n        Assert.assertEquals(\"Attachment3 had wrong name\", \"file1\", attachList.get(2).getFilename());\n\n        Assert.assertEquals(\"Attachment1 had wrong author\", \"me\", attachList.get(0).getAuthor());\n        Assert.assertEquals(\"Attachment2 had wrong author\", \"you\", attachList.get(1).getAuthor());\n        Assert.assertEquals(\"Attachment3 had wrong author\", \"them\", attachList.get(2).getAuthor());\n\n        Assert.assertEquals(\"Attachment1 had wrong version\", \"1.1\", attachList.get(0).getVersion());\n        Assert.assertEquals(\"Attachment2 had wrong version\", \"1.2\", attachList.get(1).getVersion());\n        Assert.assertEquals(\"Attachment3 had wrong version\", \"1.3\", attachList.get(2).getVersion());\n\n        Assert.assertEquals(\"Attachment1 had wrong comment\",\n            attachList.get(0).getComment(),\n            \"something whitty\");\n        Assert.assertEquals(\"Attachment2 had wrong comment\", \"a comment\", attachList.get(1).getComment());\n        Assert.assertEquals(\"Attachment3 had wrong comment\", \"i saved it\", attachList.get(2).getComment());\n\n        // We drop milliseconds for consistency with the database so last 3 digits are 0.\n        Assert.assertEquals(\"Attachment1 had wrong date.\",\n            attachList.get(0).getDate().getTime() + \"\",\n            \"1293045632000\");\n        Assert.assertEquals(\"Attachment2 had wrong date.\",\n            attachList.get(1).getDate().getTime() + \"\",\n            \"1293789456000\");\n        Assert.assertEquals(\"Attachment3 had wrong date.\",\n            attachList.get(2).getDate().getTime() + \"\",\n            \"1293012345000\");\n    }", "signature": "void testParse()", "full_signature": "@Test public void testParse()", "class_method_signature": "AttachmentListMetadataSerializerTest.testParse()", "testcase": true, "constructor": false, "invocations": ["getBytes", "parse", "close", "assertTrue", "size", "assertEquals", "getFilename", "get", "assertEquals", "getFilename", "get", "assertEquals", "getFilename", "get", "assertEquals", "getAuthor", "get", "assertEquals", "getAuthor", "get", "assertEquals", "getAuthor", "get", "assertEquals", "getVersion", "get", "assertEquals", "getVersion", "get", "assertEquals", "getVersion", "get", "assertEquals", "getComment", "get", "assertEquals", "getComment", "get", "assertEquals", "getComment", "get", "assertEquals", "getTime", "getDate", "get", "assertEquals", "getTime", "getDate", "get", "assertEquals", "getTime", "getDate", "get"]}, "focal_class": {"identifier": "AttachmentListMetadataSerializer", "superclass": "extends AbstractXMLSerializer<List<XWikiAttachment>, List<XWikiAttachment>>", "interfaces": "", "fields": [{"original_string": "private static final String ROOT_ELEMENT_NAME = \"attachment-list\";", "modifier": "private static final", "type": "String", "declarator": "ROOT_ELEMENT_NAME = \"attachment-list\"", "var_name": "ROOT_ELEMENT_NAME"}, {"original_string": "private static final String SERIALIZER_PARAM = \"serializer\";", "modifier": "private static final", "type": "String", "declarator": "SERIALIZER_PARAM = \"serializer\"", "var_name": "SERIALIZER_PARAM"}, {"original_string": "private static final String THIS_SERIALIZER = \"attachment-list-meta/1.0\";", "modifier": "private static final", "type": "String", "declarator": "THIS_SERIALIZER = \"attachment-list-meta/1.0\"", "var_name": "THIS_SERIALIZER"}, {"original_string": "@Inject\n    @Named(\"attachment-meta/1.0\")\n    private XMLSerializer<XWikiAttachment, XWikiAttachment> attachSerializer;", "modifier": "@Inject\n    @Named(\"attachment-meta/1.0\")\n    private", "type": "XMLSerializer<XWikiAttachment, XWikiAttachment>", "declarator": "attachSerializer", "var_name": "attachSerializer"}], "methods": [{"identifier": "AttachmentListMetadataSerializer", "parameters": "()", "modifiers": "public", "return": "", "signature": " AttachmentListMetadataSerializer()", "full_signature": "public  AttachmentListMetadataSerializer()", "class_method_signature": "AttachmentListMetadataSerializer.AttachmentListMetadataSerializer()", "testcase": false, "constructor": true}, {"identifier": "AttachmentListMetadataSerializer", "parameters": "(\n        final XMLSerializer<XWikiAttachment, XWikiAttachment> attachSerializer)", "modifiers": "public", "return": "", "signature": " AttachmentListMetadataSerializer(\n        final XMLSerializer<XWikiAttachment, XWikiAttachment> attachSerializer)", "full_signature": "public  AttachmentListMetadataSerializer(\n        final XMLSerializer<XWikiAttachment, XWikiAttachment> attachSerializer)", "class_method_signature": "AttachmentListMetadataSerializer.AttachmentListMetadataSerializer(\n        final XMLSerializer<XWikiAttachment, XWikiAttachment> attachSerializer)", "testcase": false, "constructor": true}, {"identifier": "parse", "parameters": "(final Element docel)", "modifiers": "@Override public", "return": "List<XWikiAttachment>", "signature": "List<XWikiAttachment> parse(final Element docel)", "full_signature": "@Override public List<XWikiAttachment> parse(final Element docel)", "class_method_signature": "AttachmentListMetadataSerializer.parse(final Element docel)", "testcase": false, "constructor": false}, {"identifier": "serialize", "parameters": "(final List<XWikiAttachment> attachments,\n        final XMLWriter writer)", "modifiers": "@Override public", "return": "void", "signature": "void serialize(final List<XWikiAttachment> attachments,\n        final XMLWriter writer)", "full_signature": "@Override public void serialize(final List<XWikiAttachment> attachments,\n        final XMLWriter writer)", "class_method_signature": "AttachmentListMetadataSerializer.serialize(final List<XWikiAttachment> attachments,\n        final XMLWriter writer)", "testcase": false, "constructor": false}], "file": "xwiki-platform-core/xwiki-platform-store/xwiki-platform-store-filesystem-oldcore/src/main/java/org/xwiki/store/serialization/xml/internal/AttachmentListMetadataSerializer.java"}, "focal_method": {"identifier": "parse", "parameters": "(final Element docel)", "modifiers": "@Override public", "return": "List<XWikiAttachment>", "body": "@Override\n    public List<XWikiAttachment> parse(final Element docel) throws IOException\n    {\n        if (!ROOT_ELEMENT_NAME.equals(docel.getName())) {\n            throw new IOException(\"XML not recognizable as archive metadata, expecting <archive> tag\");\n        }\n        if (!THIS_SERIALIZER.equals(docel.attribute(SERIALIZER_PARAM).getValue())) {\n            throw new IOException(\"Cannot parse this attachment archive metadata, it was saved with a \"\n                + \"different serializer.\");\n        }\n        final List<XWikiAttachment> attachments = new ArrayList<XWikiAttachment>(docel.elements().size());\n        for (Element attach : ((List<Element>) docel.elements())) {\n            attachments.add(this.attachSerializer.parse(attach));\n        }\n        return attachments;\n    }", "signature": "List<XWikiAttachment> parse(final Element docel)", "full_signature": "@Override public List<XWikiAttachment> parse(final Element docel)", "class_method_signature": "AttachmentListMetadataSerializer.parse(final Element docel)", "testcase": false, "constructor": false, "invocations": ["equals", "getName", "equals", "getValue", "attribute", "size", "elements", "elements", "add", "parse"]}, "repository": {"repo_id": 1463490, "url": "https://github.com/xwiki/xwiki-platform", "stars": 495, "created": "3/10/2011 1:26:41 PM +00:00", "updates": "2020-01-27T14:12:16+00:00", "fork": "False", "license": "licensed"}}