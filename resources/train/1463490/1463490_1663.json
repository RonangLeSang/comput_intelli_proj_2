{"test_class": {"identifier": "DefaultMentionXDOMServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@InjectMockComponents\n    private DefaultMentionXDOMService xdomService;", "modifier": "@InjectMockComponents\n    private", "type": "DefaultMentionXDOMService", "declarator": "xdomService", "var_name": "xdomService"}, {"original_string": "@RegisterExtension\n    LogCaptureExtension logCapture = new LogCaptureExtension(WARN);", "modifier": "@RegisterExtension", "type": "LogCaptureExtension", "declarator": "logCapture = new LogCaptureExtension(WARN)", "var_name": "logCapture"}, {"original_string": "@MockComponent\n    @Named(\"context\")\n    private Provider<ComponentManager> contextComponentManager;", "modifier": "@MockComponent\n    @Named(\"context\")\n    private", "type": "Provider<ComponentManager>", "declarator": "contextComponentManager", "var_name": "contextComponentManager"}, {"original_string": "@Mock\n    private ComponentManager componentManager;", "modifier": "@Mock\n    private", "type": "ComponentManager", "declarator": "componentManager", "var_name": "componentManager"}, {"original_string": "@MockComponent\n    private DocumentReferenceResolver<String> documentReferenceResolver;", "modifier": "@MockComponent\n    private", "type": "DocumentReferenceResolver<String>", "declarator": "documentReferenceResolver", "var_name": "documentReferenceResolver"}, {"original_string": "private DocumentReference documentReferenceA;", "modifier": "private", "type": "DocumentReference", "declarator": "documentReferenceA", "var_name": "documentReferenceA"}, {"original_string": "private DocumentReference documentReferenceB;", "modifier": "private", "type": "DocumentReference", "declarator": "documentReferenceB", "var_name": "documentReferenceB"}, {"original_string": "private DocumentReference documentReferenceC;", "modifier": "private", "type": "DocumentReference", "declarator": "documentReferenceC", "var_name": "documentReferenceC"}], "file": "xwiki-platform-core/xwiki-platform-mentions/xwiki-platform-mentions-default/src/test/java/org/xwiki/mentions/internal/DefaultMentionXDOMServiceTest.java"}, "test_case": {"identifier": "parseError", "parameters": "()", "modifiers": "@Test", "return": "void", "body": "@Test\n    void parseError() throws Exception\n    {\n        Parser parser = mock(Parser.class);\n        when(this.componentManager.getInstance(Parser.class, XWIKI_2_1.toIdString())).thenReturn(\n            parser);\n        when(parser.parse(ArgumentMatchers.any(Reader.class))).thenThrow(new ParseException(\"\"));\n\n        Optional<XDOM> actual = this.xdomService.parse(\"ABC\", XWIKI_2_1);\n\n        assertEquals(1, this.logCapture.size());\n        assertEquals(Level.WARN, this.logCapture.getLogEvent(0).getLevel());\n        assertEquals(\"Failed to parse the payload [ABC]. Cause [ParseException: ].\", this.logCapture.getMessage(0));\n\n        assertEquals(Optional.empty(), actual);\n    }", "signature": "void parseError()", "full_signature": "@Test void parseError()", "class_method_signature": "DefaultMentionXDOMServiceTest.parseError()", "testcase": true, "constructor": false, "invocations": ["mock", "thenReturn", "when", "getInstance", "toIdString", "thenThrow", "when", "parse", "any", "parse", "assertEquals", "size", "assertEquals", "getLevel", "getLogEvent", "assertEquals", "getMessage", "assertEquals", "empty"]}, "focal_class": {"identifier": "DefaultMentionXDOMService", "superclass": "", "interfaces": "implements MentionXDOMService", "fields": [{"original_string": "private static final String MENTION_MACRO_NAME = \"mention\";", "modifier": "private static final", "type": "String", "declarator": "MENTION_MACRO_NAME = \"mention\"", "var_name": "MENTION_MACRO_NAME"}, {"original_string": "private static final String REFERENCE_PARAM_NAME = \"reference\";", "modifier": "private static final", "type": "String", "declarator": "REFERENCE_PARAM_NAME = \"reference\"", "var_name": "REFERENCE_PARAM_NAME"}, {"original_string": "private static final String ANCHORID_PARAM_NAME = \"anchor\";", "modifier": "private static final", "type": "String", "declarator": "ANCHORID_PARAM_NAME = \"anchor\"", "var_name": "ANCHORID_PARAM_NAME"}, {"original_string": "@Inject\n    private Logger logger;", "modifier": "@Inject\n    private", "type": "Logger", "declarator": "logger", "var_name": "logger"}, {"original_string": "@Inject\n    @Named(\"context\")\n    private Provider<ComponentManager> componentManager;", "modifier": "@Inject\n    @Named(\"context\")\n    private", "type": "Provider<ComponentManager>", "declarator": "componentManager", "var_name": "componentManager"}, {"original_string": "@Inject\n    private DocumentReferenceResolver<String> documentReferenceResolver;", "modifier": "@Inject\n    private", "type": "DocumentReferenceResolver<String>", "declarator": "documentReferenceResolver", "var_name": "documentReferenceResolver"}], "methods": [{"identifier": "matchMentionMacro", "parameters": "(Block block)", "modifiers": "private static", "return": "boolean", "signature": "boolean matchMentionMacro(Block block)", "full_signature": "private static boolean matchMentionMacro(Block block)", "class_method_signature": "DefaultMentionXDOMService.matchMentionMacro(Block block)", "testcase": false, "constructor": false}, {"identifier": "listMentionMacros", "parameters": "(XDOM xdom)", "modifiers": "@Override public", "return": "List<MacroBlock>", "signature": "List<MacroBlock> listMentionMacros(XDOM xdom)", "full_signature": "@Override public List<MacroBlock> listMentionMacros(XDOM xdom)", "class_method_signature": "DefaultMentionXDOMService.listMentionMacros(XDOM xdom)", "testcase": false, "constructor": false}, {"identifier": "groupAnchorsByUserReference", "parameters": "(List<MacroBlock> mentions,\n        WikiReference wikiReference)", "modifiers": "@Override public", "return": "Map<DocumentReference, List<String>>", "signature": "Map<DocumentReference, List<String>> groupAnchorsByUserReference(List<MacroBlock> mentions,\n        WikiReference wikiReference)", "full_signature": "@Override public Map<DocumentReference, List<String>> groupAnchorsByUserReference(List<MacroBlock> mentions,\n        WikiReference wikiReference)", "class_method_signature": "DefaultMentionXDOMService.groupAnchorsByUserReference(List<MacroBlock> mentions,\n        WikiReference wikiReference)", "testcase": false, "constructor": false}, {"identifier": "parse", "parameters": "(String payload, Syntax syntax)", "modifiers": "@Override public", "return": "Optional<XDOM>", "signature": "Optional<XDOM> parse(String payload, Syntax syntax)", "full_signature": "@Override public Optional<XDOM> parse(String payload, Syntax syntax)", "class_method_signature": "DefaultMentionXDOMService.parse(String payload, Syntax syntax)", "testcase": false, "constructor": false}], "file": "xwiki-platform-core/xwiki-platform-mentions/xwiki-platform-mentions-default/src/main/java/org/xwiki/mentions/internal/DefaultMentionXDOMService.java"}, "focal_method": {"identifier": "parse", "parameters": "(String payload, Syntax syntax)", "modifiers": "@Override public", "return": "Optional<XDOM>", "body": "@Override\n    public Optional<XDOM> parse(String payload, Syntax syntax)\n    {\n        Optional<XDOM> oxdom;\n        try {\n            Parser instance = this.componentManager.get().getInstance(Parser.class, syntax.toIdString());\n            XDOM xdom = instance.parse(new StringReader(payload));\n            oxdom = Optional.of(xdom);\n        } catch (ParseException e) {\n            this.logger\n                .warn(\"Failed to parse the payload [{}]. Cause [{}].\", payload, ExceptionUtils.getRootCauseMessage(e));\n            oxdom = Optional.empty();\n        } catch (ComponentLookupException e) {\n            this.logger\n                .warn(\"Failed to get the parser instance [{}]. Cause [{}].\", syntax,\n                    ExceptionUtils.getRootCauseMessage(e));\n            oxdom = Optional.empty();\n        }\n        return oxdom;\n    }", "signature": "Optional<XDOM> parse(String payload, Syntax syntax)", "full_signature": "@Override public Optional<XDOM> parse(String payload, Syntax syntax)", "class_method_signature": "DefaultMentionXDOMService.parse(String payload, Syntax syntax)", "testcase": false, "constructor": false, "invocations": ["getInstance", "get", "toIdString", "parse", "of", "warn", "getRootCauseMessage", "empty", "warn", "getRootCauseMessage", "empty"]}, "repository": {"repo_id": 1463490, "url": "https://github.com/xwiki/xwiki-platform", "stars": 495, "created": "3/10/2011 1:26:41 PM +00:00", "updates": "2020-01-27T14:12:16+00:00", "fork": "False", "license": "licensed"}}