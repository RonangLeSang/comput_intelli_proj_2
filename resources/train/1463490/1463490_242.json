{"test_class": {"identifier": "DefaultEventStoreTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final DefaultEvent EVENT = new DefaultEvent();", "modifier": "private static final", "type": "DefaultEvent", "declarator": "EVENT = new DefaultEvent()", "var_name": "EVENT"}, {"original_string": "private static final DefaultEventStatus EVENTSTATUS = new DefaultEventStatus(EVENT, \"entity\", true);", "modifier": "private static final", "type": "DefaultEventStatus", "declarator": "EVENTSTATUS = new DefaultEventStatus(EVENT, \"entity\", true)", "var_name": "EVENTSTATUS"}, {"original_string": "private static final DefaultEntityEvent MAILENTITY = new DefaultEntityEvent(EVENT, \"entity\");", "modifier": "private static final", "type": "DefaultEntityEvent", "declarator": "MAILENTITY = new DefaultEntityEvent(EVENT, \"entity\")", "var_name": "MAILENTITY"}, {"original_string": "@MockComponent\n    private EventStreamConfiguration configuration;", "modifier": "@MockComponent\n    private", "type": "EventStreamConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "@MockComponent\n    @Named(\"legacy\")\n    private EventStore legacyStore;", "modifier": "@MockComponent\n    @Named(\"legacy\")\n    private", "type": "EventStore", "declarator": "legacyStore", "var_name": "legacyStore"}, {"original_string": "@MockComponent\n    @Named(\"test\")\n    private EventStore store;", "modifier": "@MockComponent\n    @Named(\"test\")\n    private", "type": "EventStore", "declarator": "store", "var_name": "store"}, {"original_string": "@InjectMockComponents\n    private DefaultEventStore defaultStore;", "modifier": "@InjectMockComponents\n    private", "type": "DefaultEventStore", "declarator": "defaultStore", "var_name": "defaultStore"}], "file": "xwiki-platform-core/xwiki-platform-eventstream/xwiki-platform-eventstream-api/src/test/java/org/xwiki/eventstream/internal/DefaultEventStoreTest.java"}, "test_case": {"identifier": "deleteMailEntityEvent", "parameters": "()", "modifiers": "@Test", "return": "void", "body": "@Test\n    void deleteMailEntityEvent() throws EventStreamException\n    {\n        this.defaultStore.deleteMailEntityEvent(MAILENTITY);\n\n        verify(this.store).deleteMailEntityEvent(MAILENTITY);\n        verify(this.legacyStore).deleteMailEntityEvent(MAILENTITY);\n    }", "signature": "void deleteMailEntityEvent()", "full_signature": "@Test void deleteMailEntityEvent()", "class_method_signature": "DefaultEventStoreTest.deleteMailEntityEvent()", "testcase": true, "constructor": false, "invocations": ["deleteMailEntityEvent", "deleteMailEntityEvent", "verify", "deleteMailEntityEvent", "verify"]}, "focal_class": {"identifier": "DefaultEventStore", "superclass": "", "interfaces": "implements EventStore, Initializable", "fields": [{"original_string": "private static final String GROUP_ID_CONTEXT_KEY = \"activitystream_requestid\";", "modifier": "private static final", "type": "String", "declarator": "GROUP_ID_CONTEXT_KEY = \"activitystream_requestid\"", "var_name": "GROUP_ID_CONTEXT_KEY"}, {"original_string": "private static final String NO_STORE = \"No event store available\";", "modifier": "private static final", "type": "String", "declarator": "NO_STORE = \"No event store available\"", "var_name": "NO_STORE"}, {"original_string": "@Inject\n    private EventStreamConfiguration configuration;", "modifier": "@Inject\n    private", "type": "EventStreamConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "@Inject\n    private ComponentManager componentManager;", "modifier": "@Inject\n    private", "type": "ComponentManager", "declarator": "componentManager", "var_name": "componentManager"}, {"original_string": "@Inject\n    private EntityReferenceSerializer<String> serializer;", "modifier": "@Inject\n    private", "type": "EntityReferenceSerializer<String>", "declarator": "serializer", "var_name": "serializer"}, {"original_string": "@Inject\n    private DocumentAccessBridge documentAccessBridge;", "modifier": "@Inject\n    private", "type": "DocumentAccessBridge", "declarator": "documentAccessBridge", "var_name": "documentAccessBridge"}, {"original_string": "@Inject\n    private WikiDescriptorManager wikiDescriptorManager;", "modifier": "@Inject\n    private", "type": "WikiDescriptorManager", "declarator": "wikiDescriptorManager", "var_name": "wikiDescriptorManager"}, {"original_string": "@Inject\n    private Execution execution;", "modifier": "@Inject\n    private", "type": "Execution", "declarator": "execution", "var_name": "execution"}, {"original_string": "private EventStore legacyStore;", "modifier": "private", "type": "EventStore", "declarator": "legacyStore", "var_name": "legacyStore"}, {"original_string": "private EventStore store;", "modifier": "private", "type": "EventStore", "declarator": "store", "var_name": "store"}], "methods": [{"identifier": "initialize", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void initialize()", "full_signature": "@Override public void initialize()", "class_method_signature": "DefaultEventStore.initialize()", "testcase": false, "constructor": false}, {"identifier": "saveEvent", "parameters": "(Event event)", "modifiers": "@Override public", "return": "CompletableFuture<Event>", "signature": "CompletableFuture<Event> saveEvent(Event event)", "full_signature": "@Override public CompletableFuture<Event> saveEvent(Event event)", "class_method_signature": "DefaultEventStore.saveEvent(Event event)", "testcase": false, "constructor": false}, {"identifier": "prefilterEvent", "parameters": "(Event event)", "modifiers": "@Override public", "return": "CompletableFuture<Event>", "signature": "CompletableFuture<Event> prefilterEvent(Event event)", "full_signature": "@Override public CompletableFuture<Event> prefilterEvent(Event event)", "class_method_signature": "DefaultEventStore.prefilterEvent(Event event)", "testcase": false, "constructor": false}, {"identifier": "deleteEvent", "parameters": "(String eventId)", "modifiers": "@Override public", "return": "CompletableFuture<Optional<Event>>", "signature": "CompletableFuture<Optional<Event>> deleteEvent(String eventId)", "full_signature": "@Override public CompletableFuture<Optional<Event>> deleteEvent(String eventId)", "class_method_signature": "DefaultEventStore.deleteEvent(String eventId)", "testcase": false, "constructor": false}, {"identifier": "deleteEvent", "parameters": "(Event event)", "modifiers": "@Override public", "return": "CompletableFuture<Optional<Event>>", "signature": "CompletableFuture<Optional<Event>> deleteEvent(Event event)", "full_signature": "@Override public CompletableFuture<Optional<Event>> deleteEvent(Event event)", "class_method_signature": "DefaultEventStore.deleteEvent(Event event)", "testcase": false, "constructor": false}, {"identifier": "saveEventStatus", "parameters": "(EventStatus status)", "modifiers": "@Override public", "return": "CompletableFuture<EventStatus>", "signature": "CompletableFuture<EventStatus> saveEventStatus(EventStatus status)", "full_signature": "@Override public CompletableFuture<EventStatus> saveEventStatus(EventStatus status)", "class_method_signature": "DefaultEventStore.saveEventStatus(EventStatus status)", "testcase": false, "constructor": false}, {"identifier": "saveMailEntityEvent", "parameters": "(EntityEvent event)", "modifiers": "@Override public", "return": "CompletableFuture<EventStatus>", "signature": "CompletableFuture<EventStatus> saveMailEntityEvent(EntityEvent event)", "full_signature": "@Override public CompletableFuture<EventStatus> saveMailEntityEvent(EntityEvent event)", "class_method_signature": "DefaultEventStore.saveMailEntityEvent(EntityEvent event)", "testcase": false, "constructor": false}, {"identifier": "deleteEventStatus", "parameters": "(EventStatus status)", "modifiers": "@Override public", "return": "CompletableFuture<Optional<EventStatus>>", "signature": "CompletableFuture<Optional<EventStatus>> deleteEventStatus(EventStatus status)", "full_signature": "@Override public CompletableFuture<Optional<EventStatus>> deleteEventStatus(EventStatus status)", "class_method_signature": "DefaultEventStore.deleteEventStatus(EventStatus status)", "testcase": false, "constructor": false}, {"identifier": "deleteEventStatuses", "parameters": "(String entityId, Date date)", "modifiers": "@Override public", "return": "CompletableFuture<Void>", "signature": "CompletableFuture<Void> deleteEventStatuses(String entityId, Date date)", "full_signature": "@Override public CompletableFuture<Void> deleteEventStatuses(String entityId, Date date)", "class_method_signature": "DefaultEventStore.deleteEventStatuses(String entityId, Date date)", "testcase": false, "constructor": false}, {"identifier": "deleteMailEntityEvent", "parameters": "(EntityEvent event)", "modifiers": "@Override public", "return": "CompletableFuture<Optional<EventStatus>>", "signature": "CompletableFuture<Optional<EventStatus>> deleteMailEntityEvent(EntityEvent event)", "full_signature": "@Override public CompletableFuture<Optional<EventStatus>> deleteMailEntityEvent(EntityEvent event)", "class_method_signature": "DefaultEventStore.deleteMailEntityEvent(EntityEvent event)", "testcase": false, "constructor": false}, {"identifier": "getEvent", "parameters": "(String eventId)", "modifiers": "@Override public", "return": "Optional<Event>", "signature": "Optional<Event> getEvent(String eventId)", "full_signature": "@Override public Optional<Event> getEvent(String eventId)", "class_method_signature": "DefaultEventStore.getEvent(String eventId)", "testcase": false, "constructor": false}, {"identifier": "search", "parameters": "(EventQuery query)", "modifiers": "@Override public", "return": "EventSearchResult", "signature": "EventSearchResult search(EventQuery query)", "full_signature": "@Override public EventSearchResult search(EventQuery query)", "class_method_signature": "DefaultEventStore.search(EventQuery query)", "testcase": false, "constructor": false}, {"identifier": "search", "parameters": "(EventQuery query, Set<String> fields)", "modifiers": "@Override public", "return": "EventSearchResult", "signature": "EventSearchResult search(EventQuery query, Set<String> fields)", "full_signature": "@Override public EventSearchResult search(EventQuery query, Set<String> fields)", "class_method_signature": "DefaultEventStore.search(EventQuery query, Set<String> fields)", "testcase": false, "constructor": false}, {"identifier": "generateEventId", "parameters": "(Event event, ExecutionContext context)", "modifiers": "private", "return": "String", "signature": "String generateEventId(Event event, ExecutionContext context)", "full_signature": "private String generateEventId(Event event, ExecutionContext context)", "class_method_signature": "DefaultEventStore.generateEventId(Event event, ExecutionContext context)", "testcase": false, "constructor": false}, {"identifier": "prepareEvent", "parameters": "(Event event)", "modifiers": "private", "return": "void", "signature": "void prepareEvent(Event event)", "full_signature": "private void prepareEvent(Event event)", "class_method_signature": "DefaultEventStore.prepareEvent(Event event)", "testcase": false, "constructor": false}], "file": "xwiki-platform-core/xwiki-platform-eventstream/xwiki-platform-eventstream-api/src/main/java/org/xwiki/eventstream/internal/DefaultEventStore.java"}, "focal_method": {"identifier": "deleteMailEntityEvent", "parameters": "(EntityEvent event)", "modifiers": "@Override public", "return": "CompletableFuture<Optional<EventStatus>>", "body": "@Override\n    public CompletableFuture<Optional<EventStatus>> deleteMailEntityEvent(EntityEvent event)\n    {\n        CompletableFuture<Optional<EventStatus>> future = null;\n\n        if (this.legacyStore != null) {\n            future = this.legacyStore.deleteMailEntityEvent(event);\n        }\n\n        if (this.store != null) {\n            // Forget about legacy store result if new store is enabled\n            future = this.store.deleteMailEntityEvent(event);\n        }\n\n        if (future == null) {\n            future = new CompletableFuture<>();\n            future.completeExceptionally(new EventStreamException(NO_STORE));\n        }\n\n        return future;\n    }", "signature": "CompletableFuture<Optional<EventStatus>> deleteMailEntityEvent(EntityEvent event)", "full_signature": "@Override public CompletableFuture<Optional<EventStatus>> deleteMailEntityEvent(EntityEvent event)", "class_method_signature": "DefaultEventStore.deleteMailEntityEvent(EntityEvent event)", "testcase": false, "constructor": false, "invocations": ["deleteMailEntityEvent", "deleteMailEntityEvent", "completeExceptionally"]}, "repository": {"repo_id": 1463490, "url": "https://github.com/xwiki/xwiki-platform", "stars": 495, "created": "3/10/2011 1:26:41 PM +00:00", "updates": "2020-01-27T14:12:16+00:00", "fork": "False", "license": "licensed"}}