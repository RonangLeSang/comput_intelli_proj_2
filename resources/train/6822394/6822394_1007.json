{"test_class": {"identifier": "SecurityContextImplTest", "superclass": "extends Assert", "interfaces": "", "fields": [], "file": "webserviceCXF/WebContent/officaldoc/apache-cxf-2.7.0-src/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/SecurityContextImplTest.java"}, "test_case": {"identifier": "testAuthenticationScheme", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAuthenticationScheme() {\n        Message m = new MessageImpl();\n        Map<String, List<String>> requestHeaders \n            = new TreeMap<String, List<String>>(String.CASE_INSENSITIVE_ORDER);\n        List<String> values = new ArrayList<String>();\n        values.add(\"Digest realm=\\\"custom\\\"\");\n        requestHeaders.put(\"Authorization\", values);\n        m.put(Message.PROTOCOL_HEADERS, requestHeaders);\n        String scheme = new SecurityContextImpl(m).getAuthenticationScheme();\n        assertEquals(\"Digest\", scheme);\n    }", "signature": "void testAuthenticationScheme()", "full_signature": "@Test public void testAuthenticationScheme()", "class_method_signature": "SecurityContextImplTest.testAuthenticationScheme()", "testcase": true, "constructor": false, "invocations": ["add", "put", "put", "getAuthenticationScheme", "assertEquals"]}, "focal_class": {"identifier": "SecurityContextImpl", "superclass": "", "interfaces": "implements SecurityContext", "fields": [{"original_string": "private Message m;", "modifier": "private", "type": "Message", "declarator": "m", "var_name": "m"}], "methods": [{"identifier": "SecurityContextImpl", "parameters": "(Message m)", "modifiers": "public", "return": "", "signature": " SecurityContextImpl(Message m)", "full_signature": "public  SecurityContextImpl(Message m)", "class_method_signature": "SecurityContextImpl.SecurityContextImpl(Message m)", "testcase": false, "constructor": true}, {"identifier": "getAuthenticationScheme", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getAuthenticationScheme()", "full_signature": "public String getAuthenticationScheme()", "class_method_signature": "SecurityContextImpl.getAuthenticationScheme()", "testcase": false, "constructor": false}, {"identifier": "getUserPrincipal", "parameters": "()", "modifiers": "public", "return": "Principal", "signature": "Principal getUserPrincipal()", "full_signature": "public Principal getUserPrincipal()", "class_method_signature": "SecurityContextImpl.getUserPrincipal()", "testcase": false, "constructor": false}, {"identifier": "isSecure", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isSecure()", "full_signature": "public boolean isSecure()", "class_method_signature": "SecurityContextImpl.isSecure()", "testcase": false, "constructor": false}, {"identifier": "isUserInRole", "parameters": "(String role)", "modifiers": "public", "return": "boolean", "signature": "boolean isUserInRole(String role)", "full_signature": "public boolean isUserInRole(String role)", "class_method_signature": "SecurityContextImpl.isUserInRole(String role)", "testcase": false, "constructor": false}], "file": "webserviceCXF/WebContent/officaldoc/apache-cxf-2.7.0-src/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/SecurityContextImpl.java"}, "focal_method": {"identifier": "getAuthenticationScheme", "parameters": "()", "modifiers": "public", "return": "String", "body": "public String getAuthenticationScheme() {\n        if (m.get(AuthorizationPolicy.class) != null) {\n            return SecurityContext.BASIC_AUTH;\n        }\n        List<String> authorizationValues = new HttpHeadersImpl(m).getRequestHeader(\"Authorization\");\n        \n        return authorizationValues.size() > 0 ? authorizationValues.get(0) : \"Unknown scheme\";\n    }", "signature": "String getAuthenticationScheme()", "full_signature": "public String getAuthenticationScheme()", "class_method_signature": "SecurityContextImpl.getAuthenticationScheme()", "testcase": false, "constructor": false, "invocations": ["get", "getRequestHeader", "size", "get"]}, "repository": {"repo_id": 6822394, "url": "https://github.com/jerrtop/Java_demo_set", "language": "Java", "is_fork": false, "fork_count": 22, "stargazer_count": 13, "size": 123833, "license": "licensed"}}