{"test_class": {"identifier": "YubicoClientTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private YubicoClient client = null;", "modifier": "private", "type": "YubicoClient", "declarator": "client = null", "var_name": "client"}, {"original_string": "private final int clientId = 21188;", "modifier": "private final", "type": "int", "declarator": "clientId = 21188", "var_name": "clientId"}, {"original_string": "private final String apiKey = \"p38Z7DuEB/JC/LbDkkjmvMRB5GI=\";", "modifier": "private final", "type": "String", "declarator": "apiKey = \"p38Z7DuEB/JC/LbDkkjmvMRB5GI=\"", "var_name": "apiKey"}], "file": "v2client/src/test/java/com/yubico/client/v2/YubicoClientTest.java"}, "test_case": {"identifier": "testValidOTPPublicId", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testValidOTPPublicId() {\n    \tString testOtp = \"cccccccfhcbelrhifnjrrddcgrburluurftrgfdrdifj\";\n    \tString testPublicId = \"cccccccfhcbe\";\n    \tString resultPublicId = YubicoClient.getPublicId(testOtp);\n    \tassertEquals(testPublicId, resultPublicId);\n    }", "signature": "void testValidOTPPublicId()", "full_signature": "@Test public void testValidOTPPublicId()", "class_method_signature": "YubicoClientTest.testValidOTPPublicId()", "testcase": true, "constructor": false, "invocations": ["getPublicId", "assertEquals"]}, "focal_class": {"identifier": "YubicoClient", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(YubicoClient.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(YubicoClient.class)", "var_name": "log"}, {"original_string": "protected Integer clientId;", "modifier": "protected", "type": "Integer", "declarator": "clientId", "var_name": "clientId"}, {"original_string": "protected byte[] key;", "modifier": "protected", "type": "byte[]", "declarator": "key", "var_name": "key"}, {"original_string": "protected Integer sync;", "modifier": "protected", "type": "Integer", "declarator": "sync", "var_name": "sync"}, {"original_string": "protected int maxRetries = 5;", "modifier": "protected", "type": "int", "declarator": "maxRetries = 5", "var_name": "maxRetries"}, {"original_string": "protected String wsapi_urls[] = {\n               \"https://api.yubico.com/wsapi/2.0/verify\"\n    \t\t};", "modifier": "protected", "type": "String", "declarator": "wsapi_urls[] = {\n               \"https://api.yubico.com/wsapi/2.0/verify\"\n    \t\t}", "var_name": "wsapi_urls"}, {"original_string": "protected String userAgent = \"yubico-java-client/\" + Version.version +\n            \" (\" + System.getProperty(\"java.vendor\") + \" \" + System.getProperty(\"java.version\") + \")\";", "modifier": "protected", "type": "String", "declarator": "userAgent = \"yubico-java-client/\" + Version.version +\n            \" (\" + System.getProperty(\"java.vendor\") + \" \" + System.getProperty(\"java.version\") + \")\"", "var_name": "userAgent"}, {"original_string": "private static final Integer OTP_MIN_LEN = 32;", "modifier": "private static final", "type": "Integer", "declarator": "OTP_MIN_LEN = 32", "var_name": "OTP_MIN_LEN"}, {"original_string": "private static final Integer OTP_MAX_LEN = 48;", "modifier": "private static final", "type": "Integer", "declarator": "OTP_MAX_LEN = 48", "var_name": "OTP_MAX_LEN"}], "methods": [{"identifier": "verify", "parameters": "(String otp)", "modifiers": "public abstract", "return": "VerificationResponse", "signature": "VerificationResponse verify(String otp)", "full_signature": "public abstract VerificationResponse verify(String otp)", "class_method_signature": "YubicoClient.verify(String otp)", "testcase": false, "constructor": false}, {"identifier": "getClientId", "parameters": "()", "modifiers": "public", "return": "Integer", "signature": "Integer getClientId()", "full_signature": "public Integer getClientId()", "class_method_signature": "YubicoClient.getClientId()", "testcase": false, "constructor": false}, {"identifier": "setClientId", "parameters": "(Integer clientId)", "modifiers": "public", "return": "void", "signature": "void setClientId(Integer clientId)", "full_signature": "public void setClientId(Integer clientId)", "class_method_signature": "YubicoClient.setClientId(Integer clientId)", "testcase": false, "constructor": false}, {"identifier": "setKey", "parameters": "(String key)", "modifiers": "public", "return": "void", "signature": "void setKey(String key)", "full_signature": "public void setKey(String key)", "class_method_signature": "YubicoClient.setKey(String key)", "testcase": false, "constructor": false}, {"identifier": "getKey", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getKey()", "full_signature": "public String getKey()", "class_method_signature": "YubicoClient.getKey()", "testcase": false, "constructor": false}, {"identifier": "setSync", "parameters": "(Integer sync)", "modifiers": "public", "return": "void", "signature": "void setSync(Integer sync)", "full_signature": "public void setSync(Integer sync)", "class_method_signature": "YubicoClient.setSync(Integer sync)", "testcase": false, "constructor": false}, {"identifier": "setMaxRetries", "parameters": "(int maxRetries)", "modifiers": "public", "return": "void", "signature": "void setMaxRetries(int maxRetries)", "full_signature": "public void setMaxRetries(int maxRetries)", "class_method_signature": "YubicoClient.setMaxRetries(int maxRetries)", "testcase": false, "constructor": false}, {"identifier": "getWsapiUrls", "parameters": "()", "modifiers": "public", "return": "String[]", "signature": "String[] getWsapiUrls()", "full_signature": "public String[] getWsapiUrls()", "class_method_signature": "YubicoClient.getWsapiUrls()", "testcase": false, "constructor": false}, {"identifier": "setWsapiUrls", "parameters": "(String[] wsapi)", "modifiers": "public", "return": "void", "signature": "void setWsapiUrls(String[] wsapi)", "full_signature": "public void setWsapiUrls(String[] wsapi)", "class_method_signature": "YubicoClient.setWsapiUrls(String[] wsapi)", "testcase": false, "constructor": false}, {"identifier": "warnIfDeprecatedUrl", "parameters": "(String url)", "modifiers": "protected", "return": "void", "signature": "void warnIfDeprecatedUrl(String url)", "full_signature": "protected void warnIfDeprecatedUrl(String url)", "class_method_signature": "YubicoClient.warnIfDeprecatedUrl(String url)", "testcase": false, "constructor": false}, {"identifier": "setUserAgent", "parameters": "(String userAgent)", "modifiers": "public", "return": "void", "signature": "void setUserAgent(String userAgent)", "full_signature": "public void setUserAgent(String userAgent)", "class_method_signature": "YubicoClient.setUserAgent(String userAgent)", "testcase": false, "constructor": false}, {"identifier": "getClient", "parameters": "(Integer clientId, String key)", "modifiers": "public static", "return": "YubicoClient", "signature": "YubicoClient getClient(Integer clientId, String key)", "full_signature": "public static YubicoClient getClient(Integer clientId, String key)", "class_method_signature": "YubicoClient.getClient(Integer clientId, String key)", "testcase": false, "constructor": false}, {"identifier": "getPublicId", "parameters": "(String otp)", "modifiers": "public static", "return": "String", "signature": "String getPublicId(String otp)", "full_signature": "public static String getPublicId(String otp)", "class_method_signature": "YubicoClient.getPublicId(String otp)", "testcase": false, "constructor": false}, {"identifier": "isValidOTPFormat", "parameters": "(String otp)", "modifiers": "public static", "return": "boolean", "signature": "boolean isValidOTPFormat(String otp)", "full_signature": "public static boolean isValidOTPFormat(String otp)", "class_method_signature": "YubicoClient.isValidOTPFormat(String otp)", "testcase": false, "constructor": false}], "file": "v2client/src/main/java/com/yubico/client/v2/YubicoClient.java"}, "focal_method": {"identifier": "getPublicId", "parameters": "(String otp)", "modifiers": "public static", "return": "String", "body": "public static String getPublicId(String otp) {\n\t\tif ((otp == null) || (otp.length() < OTP_MIN_LEN)){\n\t\t\t//not a valid OTP format, throw an exception\n\t\t\tthrow new IllegalArgumentException(\"The OTP is too short to be valid\");\n\t\t}\n\t\t\n\t\tInteger len = otp.length();\n\n\t\t/* The OTP part is always the last 32 bytes of otp. Whatever is before that\n\t\t * (if anything) is the public ID of the YubiKey. The ID can be set to ''\n\t\t * through personalization.\n\t\t */\n\t\treturn otp.substring(0, len - 32).toLowerCase();\n\t}", "signature": "String getPublicId(String otp)", "full_signature": "public static String getPublicId(String otp)", "class_method_signature": "YubicoClient.getPublicId(String otp)", "testcase": false, "constructor": false, "invocations": ["length", "length", "toLowerCase", "substring"]}, "repository": {"repo_id": 1290826, "url": "https://github.com/Yubico/yubico-java-client", "language": "Java", "is_fork": false, "fork_count": 35, "stargazer_count": 56, "size": 672, "license": "licensed"}}