{"test_class": {"identifier": "SubscriptionMailerTest", "superclass": "extends AbstractDocumentrTest", "interfaces": "", "fields": [{"original_string": "private static final String PROJECT = \"project\";", "modifier": "private static final", "type": "String", "declarator": "PROJECT = \"project\"", "var_name": "PROJECT"}, {"original_string": "private static final String BRANCH = \"branch\";", "modifier": "private static final", "type": "String", "declarator": "BRANCH = \"branch\"", "var_name": "BRANCH"}, {"original_string": "private static final String PAGE = \"page\";", "modifier": "private static final", "type": "String", "declarator": "PAGE = \"page\"", "var_name": "PAGE"}, {"original_string": "private static final String SENDER_EMAIL = \"senderEmail\";", "modifier": "private static final", "type": "String", "declarator": "SENDER_EMAIL = \"senderEmail\"", "var_name": "SENDER_EMAIL"}, {"original_string": "private static final String SENDER_NAME = \"senderName\";", "modifier": "private static final", "type": "String", "declarator": "SENDER_NAME = \"senderName\"", "var_name": "SENDER_NAME"}, {"original_string": "private static final String SUBJECT_PREFIX = \"[subjectPrefix]\";", "modifier": "private static final", "type": "String", "declarator": "SUBJECT_PREFIX = \"[subjectPrefix]\"", "var_name": "SUBJECT_PREFIX"}, {"original_string": "private static final String SUBSCRIBER_EMAIL = \"subscriberEmail\";", "modifier": "private static final", "type": "String", "declarator": "SUBSCRIBER_EMAIL = \"subscriberEmail\"", "var_name": "SUBSCRIBER_EMAIL"}, {"original_string": "private static final String PAGE_TITLE = \"pageTitle\";", "modifier": "private static final", "type": "String", "declarator": "PAGE_TITLE = \"pageTitle\"", "var_name": "PAGE_TITLE"}, {"original_string": "private static final String PAGE_TEXT = \"pageText\";", "modifier": "private static final", "type": "String", "declarator": "PAGE_TEXT = \"pageText\"", "var_name": "PAGE_TEXT"}, {"original_string": "private static final String MAIL_SUBJECT = \"mailSubject\";", "modifier": "private static final", "type": "String", "declarator": "MAIL_SUBJECT = \"mailSubject\"", "var_name": "MAIL_SUBJECT"}, {"original_string": "private static final String DOCUMENTR_HOST = \"http://documentr.org:1234\";", "modifier": "private static final", "type": "String", "declarator": "DOCUMENTR_HOST = \"http://documentr.org:1234\"", "var_name": "DOCUMENTR_HOST"}, {"original_string": "private static final String MAIL_TEXT = \"mailText\";", "modifier": "private static final", "type": "String", "declarator": "MAIL_TEXT = \"mailText\"", "var_name": "MAIL_TEXT"}, {"original_string": "private static final Locale LOCALE = new Locale(Locale.ENGLISH.getLanguage());", "modifier": "private static final", "type": "Locale", "declarator": "LOCALE = new Locale(Locale.ENGLISH.getLanguage())", "var_name": "LOCALE"}, {"original_string": "@Mock\n\tprivate JavaMailSender sender;", "modifier": "@Mock\n\tprivate", "type": "JavaMailSender", "declarator": "sender", "var_name": "sender"}, {"original_string": "@Mock\n\tprivate MailSenderFactory mailSenderFactory;", "modifier": "@Mock\n\tprivate", "type": "MailSenderFactory", "declarator": "mailSenderFactory", "var_name": "mailSenderFactory"}, {"original_string": "@Mock\n\tprivate MimeMessage message;", "modifier": "@Mock\n\tprivate", "type": "MimeMessage", "declarator": "message", "var_name": "message"}, {"original_string": "@Mock\n\tprivate SystemSettingsStore systemSettingsStore;", "modifier": "@Mock\n\tprivate", "type": "SystemSettingsStore", "declarator": "systemSettingsStore", "var_name": "systemSettingsStore"}, {"original_string": "@Mock\n\tprivate SubscriptionStore subscriptionStore;", "modifier": "@Mock\n\tprivate", "type": "SubscriptionStore", "declarator": "subscriptionStore", "var_name": "subscriptionStore"}, {"original_string": "@Mock\n\tprivate IPageStore pageStore;", "modifier": "@Mock\n\tprivate", "type": "IPageStore", "declarator": "pageStore", "var_name": "pageStore"}, {"original_string": "@Mock\n\tprivate MessageSource messageSource;", "modifier": "@Mock\n\tprivate", "type": "MessageSource", "declarator": "messageSource", "var_name": "messageSource"}, {"original_string": "@InjectMocks\n\tprivate SubscriptionMailer mailer;", "modifier": "@InjectMocks\n\tprivate", "type": "SubscriptionMailer", "declarator": "mailer", "var_name": "mailer"}], "file": "de.blizzy.documentr/src/test/java/de/blizzy/documentr/mail/SubscriptionMailerTest.java"}, "test_case": {"identifier": "pageChanged", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void pageChanged() throws IOException, MessagingException {\n\t\tmailer.pageChanged(new PageChangedEvent(PROJECT, BRANCH, PAGE));\n\n\t\tverify(message).setFrom(new InternetAddress(SENDER_EMAIL, SENDER_NAME, Charsets.UTF_8.name()));\n\t\tverify(message).setRecipient(RecipientType.TO, new InternetAddress(SUBSCRIBER_EMAIL));\n\t\tverify(message).setSubject(SUBJECT_PREFIX + \" \" + MAIL_SUBJECT, Charsets.UTF_8.name()); //$NON-NLS-1$\n\t\tverify(message).setText(MAIL_TEXT, Charsets.UTF_8.name());\n\t\tverify(sender).send(message);\n\t}", "signature": "void pageChanged()", "full_signature": "@Test public void pageChanged()", "class_method_signature": "SubscriptionMailerTest.pageChanged()", "testcase": true, "constructor": false, "invocations": ["pageChanged", "setFrom", "verify", "name", "setRecipient", "verify", "setSubject", "verify", "name", "setText", "verify", "name", "send", "verify"]}, "focal_class": {"identifier": "SubscriptionMailer", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Autowired\n\tprivate SystemSettingsStore systemSettingsStore;", "modifier": "@Autowired\n\tprivate", "type": "SystemSettingsStore", "declarator": "systemSettingsStore", "var_name": "systemSettingsStore"}, {"original_string": "@Autowired\n\tprivate ExecutorService taskExecutor;", "modifier": "@Autowired\n\tprivate", "type": "ExecutorService", "declarator": "taskExecutor", "var_name": "taskExecutor"}, {"original_string": "@Autowired\n\tprivate IPageStore pageStore;", "modifier": "@Autowired\n\tprivate", "type": "IPageStore", "declarator": "pageStore", "var_name": "pageStore"}, {"original_string": "@Autowired\n\tprivate MessageSource messageSource;", "modifier": "@Autowired\n\tprivate", "type": "MessageSource", "declarator": "messageSource", "var_name": "messageSource"}, {"original_string": "@Autowired\n\tprivate SubscriptionStore subscriptionStore;", "modifier": "@Autowired\n\tprivate", "type": "SubscriptionStore", "declarator": "subscriptionStore", "var_name": "subscriptionStore"}, {"original_string": "@Autowired\n\tprivate MailSenderFactory mailSenderFactory;", "modifier": "@Autowired\n\tprivate", "type": "MailSenderFactory", "declarator": "mailSenderFactory", "var_name": "mailSenderFactory"}], "methods": [{"identifier": "pageChanged", "parameters": "(PageChangedEvent event)", "modifiers": "@Subscribe public", "return": "void", "signature": "void pageChanged(PageChangedEvent event)", "full_signature": "@Subscribe public void pageChanged(PageChangedEvent event)", "class_method_signature": "SubscriptionMailer.pageChanged(PageChangedEvent event)", "testcase": false, "constructor": false}, {"identifier": "sendNotifications", "parameters": "(String projectName, String branchName, String path)", "modifiers": "private", "return": "void", "signature": "void sendNotifications(String projectName, String branchName, String path)", "full_signature": "private void sendNotifications(String projectName, String branchName, String path)", "class_method_signature": "SubscriptionMailer.sendNotifications(String projectName, String branchName, String path)", "testcase": false, "constructor": false}, {"identifier": "sendMail", "parameters": "(String subject, String text, String senderEmail, String senderName,\n\t\t\tSet<String> subscriberEmails, JavaMailSender sender)", "modifiers": "private", "return": "void", "signature": "void sendMail(String subject, String text, String senderEmail, String senderName,\n\t\t\tSet<String> subscriberEmails, JavaMailSender sender)", "full_signature": "private void sendMail(String subject, String text, String senderEmail, String senderName,\n\t\t\tSet<String> subscriberEmails, JavaMailSender sender)", "class_method_signature": "SubscriptionMailer.sendMail(String subject, String text, String senderEmail, String senderName,\n\t\t\tSet<String> subscriberEmails, JavaMailSender sender)", "testcase": false, "constructor": false}, {"identifier": "createAddress", "parameters": "(String email, String name)", "modifiers": "private", "return": "Address", "signature": "Address createAddress(String email, String name)", "full_signature": "private Address createAddress(String email, String name)", "class_method_signature": "SubscriptionMailer.createAddress(String email, String name)", "testcase": false, "constructor": false}, {"identifier": "createUrl", "parameters": "(Map<String, String> settings, String uri)", "modifiers": "private", "return": "String", "signature": "String createUrl(Map<String, String> settings, String uri)", "full_signature": "private String createUrl(Map<String, String> settings, String uri)", "class_method_signature": "SubscriptionMailer.createUrl(Map<String, String> settings, String uri)", "testcase": false, "constructor": false}], "file": "de.blizzy.documentr/src/main/java/de/blizzy/documentr/mail/SubscriptionMailer.java"}, "focal_method": {"identifier": "pageChanged", "parameters": "(PageChangedEvent event)", "modifiers": "@Subscribe public", "return": "void", "body": "@Subscribe\n\tpublic void pageChanged(PageChangedEvent event) {\n\t\tfinal String projectName = event.getProjectName();\n\t\tfinal String branchName = event.getBranchName();\n\t\tfinal String path = event.getPath();\n\t\tRunnable runnable = new Runnable() {\n\t\t\t@Override\n\t\t\tpublic void run() {\n\t\t\t\tlog.info(\"page changed, sending notifications: {}/{}/{}\", //$NON-NLS-1$\n\t\t\t\t\t\tprojectName, branchName, Util.toUrlPagePath(path));\n\t\t\t\ttry {\n\t\t\t\t\tsendNotifications(projectName, branchName, path);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tlog.error(\"error sending notifications\", e); //$NON-NLS-1$\n\t\t\t\t} catch (RuntimeException e) {\n\t\t\t\t\tlog.error(\"error sending notifications\", e); //$NON-NLS-1$\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\ttaskExecutor.submit(runnable);\n\t}", "signature": "void pageChanged(PageChangedEvent event)", "full_signature": "@Subscribe public void pageChanged(PageChangedEvent event)", "class_method_signature": "SubscriptionMailer.pageChanged(PageChangedEvent event)", "testcase": false, "constructor": false, "invocations": ["getProjectName", "getBranchName", "getPath", "info", "toUrlPagePath", "sendNotifications", "error", "error", "submit"]}, "repository": {"repo_id": 4238016, "url": "https://github.com/blizzy78/documentr", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 14, "size": 20324, "license": "licensed"}}