{"test_class": {"identifier": "SecurityUtilsTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private InstancedConfiguration mConfiguration;", "modifier": "private", "type": "InstancedConfiguration", "declarator": "mConfiguration", "var_name": "mConfiguration"}], "file": "core/common/src/test/java/alluxio/util/SecurityUtilsTest.java"}, "test_case": {"identifier": "getGroupFromGrpcClient", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void getGroupFromGrpcClient() throws Exception {\n    // When security is not enabled, user and group are not set\n    mConfiguration.set(PropertyKey.SECURITY_AUTHENTICATION_TYPE, AuthType.NOSASL.getAuthName());\n    assertEquals(\"\", SecurityUtils.getGroupFromGrpcClient(mConfiguration));\n\n    mConfiguration.set(PropertyKey.SECURITY_AUTHENTICATION_TYPE, AuthType.SIMPLE.getAuthName());\n    mConfiguration.set(PropertyKey.SECURITY_GROUP_MAPPING_CLASS,\n        IdentityUserGroupsMapping.class.getName());\n    AuthenticatedClientUser.set(\"test_client_user\");\n    assertEquals(\"test_client_user\", SecurityUtils.getGroupFromGrpcClient(mConfiguration));\n  }", "signature": "void getGroupFromGrpcClient()", "full_signature": "@Test public void getGroupFromGrpcClient()", "class_method_signature": "SecurityUtilsTest.getGroupFromGrpcClient()", "testcase": true, "constructor": false, "invocations": ["set", "getAuthName", "assertEquals", "getGroupFromGrpcClient", "set", "getAuthName", "set", "getName", "set", "assertEquals", "getGroupFromGrpcClient"]}, "focal_class": {"identifier": "SecurityUtils", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "SecurityUtils", "parameters": "()", "modifiers": "private", "return": "", "signature": " SecurityUtils()", "full_signature": "private  SecurityUtils()", "class_method_signature": "SecurityUtils.SecurityUtils()", "testcase": false, "constructor": true}, {"identifier": "isSecurityEnabled", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "boolean", "signature": "boolean isSecurityEnabled(AlluxioConfiguration conf)", "full_signature": "public static boolean isSecurityEnabled(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.isSecurityEnabled(AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "isAuthenticationEnabled", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "boolean", "signature": "boolean isAuthenticationEnabled(AlluxioConfiguration conf)", "full_signature": "public static boolean isAuthenticationEnabled(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.isAuthenticationEnabled(AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "isAuthorizationEnabled", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "boolean", "signature": "boolean isAuthorizationEnabled(AlluxioConfiguration conf)", "full_signature": "public static boolean isAuthorizationEnabled(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.isAuthorizationEnabled(AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "getOwnerFromGrpcClient", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "String", "signature": "String getOwnerFromGrpcClient(AlluxioConfiguration conf)", "full_signature": "public static String getOwnerFromGrpcClient(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.getOwnerFromGrpcClient(AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "getGroupFromGrpcClient", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "String", "signature": "String getGroupFromGrpcClient(AlluxioConfiguration conf)", "full_signature": "public static String getGroupFromGrpcClient(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.getGroupFromGrpcClient(AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "getOwner", "parameters": "(UserState userState)", "modifiers": "public static", "return": "String", "signature": "String getOwner(UserState userState)", "full_signature": "public static String getOwner(UserState userState)", "class_method_signature": "SecurityUtils.getOwner(UserState userState)", "testcase": false, "constructor": false}, {"identifier": "getGroup", "parameters": "(UserState userState, AlluxioConfiguration conf)", "modifiers": "public static", "return": "String", "signature": "String getGroup(UserState userState, AlluxioConfiguration conf)", "full_signature": "public static String getGroup(UserState userState, AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.getGroup(UserState userState, AlluxioConfiguration conf)", "testcase": false, "constructor": false}, {"identifier": "createLoginContext", "parameters": "(AuthType authType, Subject subject,\n      ClassLoader classLoader, Configuration configuration, CallbackHandler callbackHandler)", "modifiers": "public static", "return": "LoginContext", "signature": "LoginContext createLoginContext(AuthType authType, Subject subject,\n      ClassLoader classLoader, Configuration configuration, CallbackHandler callbackHandler)", "full_signature": "public static LoginContext createLoginContext(AuthType authType, Subject subject,\n      ClassLoader classLoader, Configuration configuration, CallbackHandler callbackHandler)", "class_method_signature": "SecurityUtils.createLoginContext(AuthType authType, Subject subject,\n      ClassLoader classLoader, Configuration configuration, CallbackHandler callbackHandler)", "testcase": false, "constructor": false}], "file": "core/common/src/main/java/alluxio/util/SecurityUtils.java"}, "focal_method": {"identifier": "getGroupFromGrpcClient", "parameters": "(AlluxioConfiguration conf)", "modifiers": "public static", "return": "String", "body": "public static String getGroupFromGrpcClient(AlluxioConfiguration conf) {\n    try {\n      User user = AuthenticatedClientUser.get(conf);\n      if (user == null) {\n        return \"\";\n      }\n      return CommonUtils.getPrimaryGroupName(user.getName(), conf);\n    } catch (IOException e) {\n      return \"\";\n    }\n  }", "signature": "String getGroupFromGrpcClient(AlluxioConfiguration conf)", "full_signature": "public static String getGroupFromGrpcClient(AlluxioConfiguration conf)", "class_method_signature": "SecurityUtils.getGroupFromGrpcClient(AlluxioConfiguration conf)", "testcase": false, "constructor": false, "invocations": ["get", "getPrimaryGroupName", "getName"]}, "repository": {"repo_id": 7276954, "url": "https://github.com/Alluxio/alluxio", "stars": 4494, "created": "12/21/2012 5:43:46 PM +00:00", "updates": "2020-01-24T20:27:46+00:00", "fork": "False", "license": "licensed"}}