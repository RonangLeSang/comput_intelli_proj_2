{"test_class": {"identifier": "HadoopProductionTypeTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private HadoopProductionType productionType;", "modifier": "private", "type": "HadoopProductionType", "declarator": "productionType", "var_name": "productionType"}], "file": "calvalus-production/src/test/java/com/bc/calvalus/production/hadoop/HadoopProductionTypeTest.java"}, "test_case": {"identifier": "testGetOutputPath", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetOutputPath() throws Exception {\n\n        // default dir\n        ProductionRequest productionRequest = new ProductionRequest(\"X\", \"eva\");\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/home/eva/idsuffix\", productionType.getOutputPath(productionRequest, \"id\", \"suffix\"));\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/home/eva/id\", productionType.getOutputPath(productionRequest, \"id\", \"\"));\n\n        // outputPath\n        productionRequest = new ProductionRequest(\"X\", \"eva\", \"outputPath\", \"blob\");\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/blobsuffix\", productionType.getOutputPath(productionRequest, \"id\", \"suffix\"));\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/blob\", productionType.getOutputPath(productionRequest, \"id\", \"\"));\n\n        // outputPath + calvalus.output.dir\n        productionRequest = new ProductionRequest(\"X\", \"eva\", \"outputPath\", \"blob\", \"calvalus.output.dir\", \"hop\");\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/hopsuffix\", productionType.getOutputPath(productionRequest, \"id\", \"suffix\"));\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/hop\", productionType.getOutputPath(productionRequest, \"id\", \"\"));\n\n        // outputPath + calvalus.output.dir + trailing SLASH\n        productionRequest = new ProductionRequest(\"X\", \"eva\", \"outputPath\", \"blob\", \"calvalus.output.dir\", \"hop/\");\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/hopsuffix\", productionType.getOutputPath(productionRequest, \"id\", \"suffix\"));\n        assertEquals(\"hdfs://master00:9000/calvalus/outputs/hop\", productionType.getOutputPath(productionRequest, \"id\", \"\"));\n    }", "signature": "void testGetOutputPath()", "full_signature": "@Test public void testGetOutputPath()", "class_method_signature": "HadoopProductionTypeTest.testGetOutputPath()", "testcase": true, "constructor": false, "invocations": ["assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath", "assertEquals", "getOutputPath"]}, "focal_class": {"identifier": "HadoopProductionType", "superclass": "", "interfaces": "implements ProductionType", "fields": [{"original_string": "private final String name;", "modifier": "private final", "type": "String", "declarator": "name", "var_name": "name"}, {"original_string": "private final FileSystemService fileSystemService;", "modifier": "private final", "type": "FileSystemService", "declarator": "fileSystemService", "var_name": "fileSystemService"}, {"original_string": "private final HadoopProcessingService processingService;", "modifier": "private final", "type": "HadoopProcessingService", "declarator": "processingService", "var_name": "processingService"}, {"original_string": "private final StagingService stagingService;", "modifier": "private final", "type": "StagingService", "declarator": "stagingService", "var_name": "stagingService"}], "methods": [{"identifier": "HadoopProductionType", "parameters": "(String name,\n                                   FileSystemService fileSystemService,\n                                   HadoopProcessingService processingService,\n                                   StagingService stagingService)", "modifiers": "protected", "return": "", "signature": " HadoopProductionType(String name,\n                                   FileSystemService fileSystemService,\n                                   HadoopProcessingService processingService,\n                                   StagingService stagingService)", "full_signature": "protected  HadoopProductionType(String name,\n                                   FileSystemService fileSystemService,\n                                   HadoopProcessingService processingService,\n                                   StagingService stagingService)", "class_method_signature": "HadoopProductionType.HadoopProductionType(String name,\n                                   FileSystemService fileSystemService,\n                                   HadoopProcessingService processingService,\n                                   StagingService stagingService)", "testcase": false, "constructor": true}, {"identifier": "createProductionName", "parameters": "(String prefix, ProductionRequest productionRequest)", "modifiers": "protected static", "return": "String", "signature": "String createProductionName(String prefix, ProductionRequest productionRequest)", "full_signature": "protected static String createProductionName(String prefix, ProductionRequest productionRequest)", "class_method_signature": "HadoopProductionType.createProductionName(String prefix, ProductionRequest productionRequest)", "testcase": false, "constructor": false}, {"identifier": "getFileSystemService", "parameters": "()", "modifiers": "public", "return": "FileSystemService", "signature": "FileSystemService getFileSystemService()", "full_signature": "public FileSystemService getFileSystemService()", "class_method_signature": "HadoopProductionType.getFileSystemService()", "testcase": false, "constructor": false}, {"identifier": "getProcessingService", "parameters": "()", "modifiers": "public", "return": "HadoopProcessingService", "signature": "HadoopProcessingService getProcessingService()", "full_signature": "public HadoopProcessingService getProcessingService()", "class_method_signature": "HadoopProductionType.getProcessingService()", "testcase": false, "constructor": false}, {"identifier": "getStagingService", "parameters": "()", "modifiers": "public", "return": "StagingService", "signature": "StagingService getStagingService()", "full_signature": "public StagingService getStagingService()", "class_method_signature": "HadoopProductionType.getStagingService()", "testcase": false, "constructor": false}, {"identifier": "getName", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String getName()", "full_signature": "@Override public String getName()", "class_method_signature": "HadoopProductionType.getName()", "testcase": false, "constructor": false}, {"identifier": "accepts", "parameters": "(ProductionRequest productionRequest)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean accepts(ProductionRequest productionRequest)", "full_signature": "@Override public boolean accepts(ProductionRequest productionRequest)", "class_method_signature": "HadoopProductionType.accepts(ProductionRequest productionRequest)", "testcase": false, "constructor": false}, {"identifier": "createStaging", "parameters": "(Production production)", "modifiers": "@Override public", "return": "Staging", "signature": "Staging createStaging(Production production)", "full_signature": "@Override public Staging createStaging(Production production)", "class_method_signature": "HadoopProductionType.createStaging(Production production)", "testcase": false, "constructor": false}, {"identifier": "setInputLocationParameters", "parameters": "(ProductionRequest productionRequest, Configuration conf)", "modifiers": "protected", "return": "void", "signature": "void setInputLocationParameters(ProductionRequest productionRequest, Configuration conf)", "full_signature": "protected void setInputLocationParameters(ProductionRequest productionRequest, Configuration conf)", "class_method_signature": "HadoopProductionType.setInputLocationParameters(ProductionRequest productionRequest, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "createUnsubmittedStaging", "parameters": "(Production production)", "modifiers": "protected", "return": "Staging", "signature": "Staging createUnsubmittedStaging(Production production)", "full_signature": "protected Staging createUnsubmittedStaging(Production production)", "class_method_signature": "HadoopProductionType.createUnsubmittedStaging(Production production)", "testcase": false, "constructor": false}, {"identifier": "createJobConfig", "parameters": "(ProductionRequest productionRequest)", "modifiers": "protected final", "return": "Configuration", "signature": "Configuration createJobConfig(ProductionRequest productionRequest)", "full_signature": "protected final Configuration createJobConfig(ProductionRequest productionRequest)", "class_method_signature": "HadoopProductionType.createJobConfig(ProductionRequest productionRequest)", "testcase": false, "constructor": false}, {"identifier": "setDefaultProcessorParameters", "parameters": "(ProcessorProductionRequest processorProductionRequest,\n                                                       Configuration jobConfig)", "modifiers": "protected final", "return": "void", "signature": "void setDefaultProcessorParameters(ProcessorProductionRequest processorProductionRequest,\n                                                       Configuration jobConfig)", "full_signature": "protected final void setDefaultProcessorParameters(ProcessorProductionRequest processorProductionRequest,\n                                                       Configuration jobConfig)", "class_method_signature": "HadoopProductionType.setDefaultProcessorParameters(ProcessorProductionRequest processorProductionRequest,\n                                                       Configuration jobConfig)", "testcase": false, "constructor": false}, {"identifier": "setRequestParameters", "parameters": "(ProductionRequest productionRequest, Configuration jobConfig)", "modifiers": "protected final", "return": "void", "signature": "void setRequestParameters(ProductionRequest productionRequest, Configuration jobConfig)", "full_signature": "protected final void setRequestParameters(ProductionRequest productionRequest, Configuration jobConfig)", "class_method_signature": "HadoopProductionType.setRequestParameters(ProductionRequest productionRequest, Configuration jobConfig)", "testcase": false, "constructor": false}, {"identifier": "getOutputPath", "parameters": "(ProductionRequest productionRequest, String productionId, String dirSuffix)", "modifiers": "protected", "return": "String", "signature": "String getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "full_signature": "protected String getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "class_method_signature": "HadoopProductionType.getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "testcase": false, "constructor": false}, {"identifier": "successfullyCompleted", "parameters": "(String outputDir)", "modifiers": "protected", "return": "boolean", "signature": "boolean successfullyCompleted(String outputDir)", "full_signature": "protected boolean successfullyCompleted(String outputDir)", "class_method_signature": "HadoopProductionType.successfullyCompleted(String outputDir)", "testcase": false, "constructor": false}, {"identifier": "setJobConfig", "parameters": "(Map<String, String> parameters, Configuration jobConfig)", "modifiers": "public static", "return": "void", "signature": "void setJobConfig(Map<String, String> parameters, Configuration jobConfig)", "full_signature": "public static void setJobConfig(Map<String, String> parameters, Configuration jobConfig)", "class_method_signature": "HadoopProductionType.setJobConfig(Map<String, String> parameters, Configuration jobConfig)", "testcase": false, "constructor": false}], "file": "calvalus-production/src/main/java/com/bc/calvalus/production/hadoop/HadoopProductionType.java"}, "focal_method": {"identifier": "getOutputPath", "parameters": "(ProductionRequest productionRequest, String productionId, String dirSuffix)", "modifiers": "protected", "return": "String", "body": "protected String getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix) throws ProductionException {\n        String relDir = productionRequest.getString(\"outputDir\", productionId);\n        String defaultDir = String.format(\"home/%s/%s\", productionRequest.getUserName(), relDir);\n        String outputPath = productionRequest.getString(\"outputPath\", defaultDir);\n        String outputDir = productionRequest.getString(JobConfigNames.CALVALUS_OUTPUT_DIR, outputPath);\n        if (outputDir.endsWith(\"/\")) {\n            outputDir = outputDir.substring(0, outputDir.length() - 1);\n        }\n        try {\n            return getFileSystemService().getQualifiedPath(productionRequest.getUserName(), outputDir + dirSuffix);\n        } catch (IOException e) {\n            throw new ProductionException(e);\n        }\n    }", "signature": "String getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "full_signature": "protected String getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "class_method_signature": "HadoopProductionType.getOutputPath(ProductionRequest productionRequest, String productionId, String dirSuffix)", "testcase": false, "constructor": false, "invocations": ["getString", "format", "getUserName", "getString", "getString", "endsWith", "substring", "length", "getQualifiedPath", "getFileSystemService", "getUserName"]}, "repository": {"repo_id": 542927, "url": "https://github.com/bcdev/calvalus2", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 12, "size": 126408, "license": "licensed"}}