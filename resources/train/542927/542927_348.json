{"test_class": {"identifier": "CalvalusStagingTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String DUMMY_PATH = \"dummyPath\";", "modifier": "private static final", "type": "String", "declarator": "DUMMY_PATH = \"dummyPath\"", "var_name": "DUMMY_PATH"}, {"original_string": "private static final String DUMMY_JOB_ID = \"jobId\";", "modifier": "private static final", "type": "String", "declarator": "DUMMY_JOB_ID = \"jobId\"", "var_name": "DUMMY_JOB_ID"}, {"original_string": "private static final String DUMMY_USER_NAME = \"dummyUser\";", "modifier": "private static final", "type": "String", "declarator": "DUMMY_USER_NAME = \"dummyUser\"", "var_name": "DUMMY_USER_NAME"}, {"original_string": "private WpsServerContext mockServerContext;", "modifier": "private", "type": "WpsServerContext", "declarator": "mockServerContext", "var_name": "mockServerContext"}, {"original_string": "private Production mockProduction;", "modifier": "private", "type": "Production", "declarator": "mockProduction", "var_name": "mockProduction"}, {"original_string": "private ProductionService mockProductionService;", "modifier": "private", "type": "ProductionService", "declarator": "mockProductionService", "var_name": "mockProductionService"}, {"original_string": "private CalvalusStaging calvalusStaging;", "modifier": "private", "type": "CalvalusStaging", "declarator": "calvalusStaging", "var_name": "calvalusStaging"}], "file": "calvalus-wps-impl/src/test/java/com/bc/calvalus/wps/calvalusfacade/CalvalusStagingTest.java"}, "test_case": {"identifier": "canCatchExceptionWhenGetResultUrls", "parameters": "()", "modifiers": "@Test(expected = WpsResultProductException.class) public", "return": "void", "body": "@Test(expected = WpsResultProductException.class)\n    public void canCatchExceptionWhenGetResultUrls() throws Exception {\n        mockProductionService = mock(ProductionService.class);\n        when(mockProductionService.getProduction(anyString())).thenThrow(new ProductionException(\"error in getting production\"));\n        ServiceContainer mockServiceContainer = mock(ServiceContainer.class);\n        PowerMockito.when(mockServiceContainer.getProductionService()).thenReturn(mockProductionService);\n        PowerMockito.when(CalvalusProductionService.getServiceContainerSingleton()).thenReturn(mockServiceContainer);\n        Map<String, String> mockCalvalusDefaultConfig = getMockDefaultConfig();\n\n        calvalusStaging = new CalvalusStaging(mockServerContext);\n        calvalusStaging.getProductResultUrls(\"jobId\", mockCalvalusDefaultConfig);\n    }", "signature": "void canCatchExceptionWhenGetResultUrls()", "full_signature": "@Test(expected = WpsResultProductException.class) public void canCatchExceptionWhenGetResultUrls()", "class_method_signature": "CalvalusStagingTest.canCatchExceptionWhenGetResultUrls()", "testcase": true, "constructor": false, "invocations": ["mock", "thenThrow", "when", "getProduction", "anyString", "mock", "thenReturn", "when", "getProductionService", "thenReturn", "when", "getServiceContainerSingleton", "getMockDefaultConfig", "getProductResultUrls"]}, "focal_class": {"identifier": "CalvalusStaging", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = CalvalusLogger.getLogger();", "modifier": "private static final", "type": "Logger", "declarator": "LOG = CalvalusLogger.getLogger()", "var_name": "LOG"}, {"original_string": "private static final String CALWPS_ROOT_PATH = PropertiesWrapper.get(\"wps.application.path\");", "modifier": "private static final", "type": "String", "declarator": "CALWPS_ROOT_PATH = PropertiesWrapper.get(\"wps.application.path\")", "var_name": "CALWPS_ROOT_PATH"}, {"original_string": "private static final String APP_NAME = PropertiesWrapper.get(\"wps.application.name\");", "modifier": "private static final", "type": "String", "declarator": "APP_NAME = PropertiesWrapper.get(\"wps.application.name\")", "var_name": "APP_NAME"}, {"original_string": "private final WpsServerContext wpsServerContext;", "modifier": "private final", "type": "WpsServerContext", "declarator": "wpsServerContext", "var_name": "wpsServerContext"}], "methods": [{"identifier": "CalvalusStaging", "parameters": "(WpsServerContext wpsServerContext)", "modifiers": "", "return": "", "signature": " CalvalusStaging(WpsServerContext wpsServerContext)", "full_signature": "  CalvalusStaging(WpsServerContext wpsServerContext)", "class_method_signature": "CalvalusStaging.CalvalusStaging(WpsServerContext wpsServerContext)", "testcase": false, "constructor": true}, {"identifier": "stageProduction", "parameters": "(String jobid)", "modifiers": "", "return": "void", "signature": "void stageProduction(String jobid)", "full_signature": " void stageProduction(String jobid)", "class_method_signature": "CalvalusStaging.stageProduction(String jobid)", "testcase": false, "constructor": false}, {"identifier": "getProductResultUrls", "parameters": "(String jobId, Map<String, String> calvalusDefaultConfig)", "modifiers": "", "return": "List<String>", "signature": "List<String> getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "full_signature": " List<String> getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "class_method_signature": "CalvalusStaging.getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "testcase": false, "constructor": false}, {"identifier": "observeStagingStatus", "parameters": "(String jobId)", "modifiers": "", "return": "void", "signature": "void observeStagingStatus(String jobId)", "full_signature": " void observeStagingStatus(String jobId)", "class_method_signature": "CalvalusStaging.observeStagingStatus(String jobId)", "testcase": false, "constructor": false}, {"identifier": "generateProductMetadata", "parameters": "(String jobId, Map<String, String> calvalusDefaultConfig)", "modifiers": "", "return": "void", "signature": "void generateProductMetadata(String jobId, Map<String, String> calvalusDefaultConfig)", "full_signature": " void generateProductMetadata(String jobId, Map<String, String> calvalusDefaultConfig)", "class_method_signature": "CalvalusStaging.generateProductMetadata(String jobId, Map<String, String> calvalusDefaultConfig)", "testcase": false, "constructor": false}, {"identifier": "doGetProductResultUrls", "parameters": "(Production production, String stagingDirectoryPath, File[] productResultFiles)", "modifiers": "private", "return": "List<String>", "signature": "List<String> doGetProductResultUrls(Production production, String stagingDirectoryPath, File[] productResultFiles)", "full_signature": "private List<String> doGetProductResultUrls(Production production, String stagingDirectoryPath, File[] productResultFiles)", "class_method_signature": "CalvalusStaging.doGetProductResultUrls(Production production, String stagingDirectoryPath, File[] productResultFiles)", "testcase": false, "constructor": false}], "file": "calvalus-wps-impl/src/main/java/com/bc/calvalus/wps/calvalusfacade/CalvalusStaging.java"}, "focal_method": {"identifier": "getProductResultUrls", "parameters": "(String jobId, Map<String, String> calvalusDefaultConfig)", "modifiers": "", "return": "List<String>", "body": "List<String> getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig) throws WpsResultProductException {\n        Production production;\n        try {\n            ProductionService productionService = CalvalusProductionService.getServiceContainerSingleton().getProductionService();\n            production = productionService.getProduction(jobId);\n        } catch (ProductionException | IOException exception) {\n            throw new WpsResultProductException(exception);\n        }\n        String stagingDirectoryPath = calvalusDefaultConfig.get(\"calvalus.wps.staging.path\") + \"/\" + production.getStagingPath();\n        File stagingDirectory = new File(System.getProperty(\"catalina.base\") + CALWPS_ROOT_PATH + \"/\" + stagingDirectoryPath);\n        CalvalusLogger.getLogger().info(\"looking up results in staging dir \" + stagingDirectory);\n\n        Optional<File[]> productResultFiles = Optional.ofNullable(stagingDirectory.listFiles());\n        if (productResultFiles.isPresent()) {\n            return doGetProductResultUrls(production, stagingDirectoryPath, productResultFiles.get());\n        } else {\n            return new ArrayList<>();\n        }\n    }", "signature": "List<String> getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "full_signature": " List<String> getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "class_method_signature": "CalvalusStaging.getProductResultUrls(String jobId, Map<String, String> calvalusDefaultConfig)", "testcase": false, "constructor": false, "invocations": ["getProductionService", "getServiceContainerSingleton", "getProduction", "get", "getStagingPath", "getProperty", "info", "getLogger", "ofNullable", "listFiles", "isPresent", "doGetProductResultUrls", "get"]}, "repository": {"repo_id": 542927, "url": "https://github.com/bcdev/calvalus2", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 12, "size": 126408, "license": "licensed"}}